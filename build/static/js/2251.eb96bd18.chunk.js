"use strict";(self.webpackChunkdentest=self.webpackChunkdentest||[]).push([[2251],{10521:(e,t,n)=>{n.r(t),n.d(t,{default:()=>O});var i=n(79722),s=n(65043),a=n(58786),l=n(85875),o=(n(81027),n(76583)),r=(n(30064),n(55191)),d=n.n(r),c=(n(34081),n(21344),n(30232),n(14635)),u=(n(36622),n(91814)),m=n(83003),x=n(89379),h=n(90096),p=n(10506),A=n.n(p),g=n(2853),j=(n(344),n(95492),n(47295),n(62299),n(71831)),y=n(7353),f=n(94496),S=n(17392),b=n(61596),v=n(5146),w=n(11906),_=n(71806),I=n(84882),z=n(28076),C=n(10039),D=n(73460),W=n(40614),k=n(71360),P=n(9855),M=n(89577),q=n(53226),N=n(97),R=n(70579);function B(e){var t,n,a,r,c;let{AddSellModal:p,close:B,records:T,setRecords:O,moneys:Y,belance:F,setbelance:E,setAddBalanceModal:H,options1:Q,setOptions1:G}=e;const L=(0,o.N)(),K=(0,m.wA)(),{settings:V,errors:J,statuss:U}=(0,m.d4)(e=>e.settings),{sidebars:X}=(0,m.d4)(e=>e.sidebars);(0,s.useEffect)(()=>{U||0!==(null==V?void 0:V.lenght)||K((0,u.mt)())},[K,U]);const{items:Z,errori:$}=(0,m.d4)(e=>e.items),[ee,te]=(0,s.useState)(d()()),[ne,ie]=(0,s.useState)(),[se,ae]=(0,s.useState)(),[le,oe]=(0,s.useState)(d()()),[re,de]=(0,s.useState)(!1),[ce,ue]=(0,s.useState)({id:0,belance:0}),[me,xe]=(0,s.useState)([]),[he,pe]=(0,s.useState)(0),[Ae,ge]=(0,s.useState)({purchase:null,stocks_id:"",qty:null,weight:null,dateInsert:(new Date).toISOString(),rate:null,user_id:localStorage.getItem("userTokenid"),purchase_price:null,description:"",sell_price:null,expiry_date:(new Date).toISOString(),accounts_id:"",money:"",stock:{name:""},e_id:1}),[je,ye]=(0,s.useState)([]),[fe,Se]=(0,s.useState)(0),[be,ve]=(0,s.useState)(0),we=e=>{var t;let n=0;if(je.length<=0)return void L({position:"top-end",icon:"error",title:(0,R.jsx)(q.A,{id:"Select an item!"}),showConfirmButton:!1,timer:1e3});let s=[];je.forEach(e=>{s.push({purchase:e.purchase,stocks_id:e.stocks_id,qty:e.qty,weight:e.weight,dateInsert:e.dateInsert,rate:e.rate,user_id:e.user_id,purchase_price:e.purchase_price,description:e.description,expiry_date:e.expiry_date,bill_id:"",accounts_id:e.accounts_id})});let a={arr:s};i.A.post(l.A.getAddress()+"/api/purchasereturn",a,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))},params:{bill_prev:Fe,Exesting:null!=Ge&&Ge.accounts_id?"ok":"no",money:(null==Ge?void 0:Ge.money_id)||0,accounts_id:null===(t=Ge.accounts)||void 0===t?void 0:t.account_id,PaidAmount:Be||0,TotalAmount:fe,CustomerName:Ge.temp_customer,DateInsert:ee,bill_id:Ge.id}}).then(t=>{var i;e&&(e=>{const t=new j.default;t.setFontSize(26),t.setFont("helvetica","bold"),t.setTextColor(11,105,255),t.text("Invoice",105,10,null,null,"center"),t.setFontSize(14),t.setFont("helvetica","normal"),t.setTextColor(0,0,0),t.text("".concat(V[0].company_name),105,20,null,null,"center"),t.setFontSize(12),t.text("Seller Name: ".concat(ne?ne.name.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"N/A"),105,28,null,null,"center"),t.setFontSize(14),t.setTextColor(11,105,255),t.text("Invoice Number: ".concat(e),5,19),t.setFontSize(12),t.setTextColor(0,0,0);const n=new Date(ee);let i="".concat(n.getFullYear(),"-").concat(String(n.getMonth()+1).padStart(2,"0"),"-").concat(String(n.getDate()).padStart(2,"0"));const s=n.getHours(),a=n.getMinutes();let o=s>=12?"pm":"am";const r=s%12||12,c=a<10?"0"+a:a;"Persian"===localStorage.getItem("date")?(d().locale("fa"),o=s>=12?"pm":"am",i=d()(ee).format("jYYYY/jMM/jDD")):d().locale("en");const u="".concat(i," ").concat(r,":").concat(c," ").concat(o);if(t.text("Date:".concat(u),5,29),t.setDrawColor(0,0,0),t.setLineWidth(.5),t.line(5,35,205,35),V[0].company_pic){const e=V[0].company_pic.split("/").pop();t.addImage(l.A.getAddress()+"/api/getImage/"+e,"JPEG",180,5,25,25)}else t.setFontSize(12),t.text("No Company Image Available",150,20);t.autoTable({startY:40,head:[["No","Name","Quantity","Price","Total"]],body:je.map(e=>[e.e_id,e.stock.name,e.qty,e.sell_price+"".concat(Me?Me.name:"N/A"),e.sell_price*e.qty+"".concat(Me?Me.name:"N/A")]),theme:"grid",headStyles:{fillColor:[11,105,255],textColor:[255,255,255],fontSize:10,fontStyle:"bold"},bodyStyles:{fontSize:10,textColor:[0,0,0],fillColor:[255,255,255]},alternateRowStyles:{fillColor:[245,245,245]}});const m=t.lastAutoTable.finalY||40;t.setFontSize(9),t.setTextColor(0,0,0),t.text("Total Amount: ".concat(fe)+"".concat(Me?Me.name:"N/A"),152,m+5),t.text("Paid Amount: ".concat(Be||"0.00")+"".concat(Me?Me.name:"N/A"),152,m+10),t.text("Belance: ".concat(ce.belance)+"".concat(Me?Me.name:"N/A"),152,m+15),m+15>144?(t.setDrawColor(0,0,0),t.setLineWidth(.5),t.line(5,278,205,278),t.text("Address: ".concat(V[0].address),10,283),t.text("Phone: ".concat(V[0].phone),80,283),t.text("Email: ".concat(V[0].email),140,283)):(t.setDrawColor(0,0,0),t.setLineWidth(.5),t.line(5,139,205,139),t.setFontSize(12),t.text("Address: ".concat(V[0].address),10,144),t.text("Phone: ".concat(V[0].phone),80,144),t.text("Email: ".concat(V[0].email),140,144));const x=t.output("bloburl"),h=document.createElement("iframe");h.style.display="none",h.src=x,document.body.appendChild(h),h.contentWindow.print()})(t.data.bill.id),t.data.bill.money=Ke,t.data.bill.accounts={account:null==Ge||null===(i=Ge.accounts)||void 0===i?void 0:i.account},t.data.bill.temp_customer=Ge.temp_customer,n=t.data.bill.id;let s={purchase:je,bill:t.data.bill,money:Ke};O([s,...T]),te(d()()),ie({name:""}),ae({name:"",type:{measuring:""}}),oe(d()()),ve(0),ge({purchase:null,stocks_id:0,qty:0,weight:0,dateInsert:(new Date).toISOString(),rate:0,user_id:localStorage.getItem("userTokenid"),purchase_price:0,description:"Description",sell_price:0,expiry_date:(new Date).toISOString(),accounts_id:""}),We(""),Pe(""),ue({id:0,belance:0}),qe({name:""}),de(!1),ye([]),te(d()()),ie(),qe(),ue({id:0,belance:0}),Se(0),Te(0),pe(0),L({position:"top-end",icon:"success",title:(0,R.jsx)(q.A,{id:"Your record has been added!"}),showConfirmButton:!1,timer:1e3})}).catch(e=>{L({position:"top-end",icon:"error",title:(0,R.jsx)(q.A,{id:"You must enter the customer name!"}),showConfirmButton:!1,timer:1e3})})},_e=e=>{ge((0,x.A)((0,x.A)({},Ae),{},{[e.target.name]:e.target.value}))},[Ie,ze]=(0,s.useState)(),Ce=async e=>{},[De,We]=(0,s.useState)(""),[ke,Pe]=(0,s.useState)(""),[Me,qe]=(0,s.useState)({name:""}),Ne=(0,s.useRef)(null),Re=e=>{"Enter"===e.key&&(e.preventDefault(),Ne.current&&p&&Ne.current.click())},[Be,Te]=(0,s.useState)(0);(0,s.useEffect)(()=>{ue(Be?e=>(0,x.A)((0,x.A)({},e),{},{belance:Be-fe||0}):e=>(0,x.A)((0,x.A)({},e),{},{belance:-fe}))},[Be,fe,je]);const[Oe,Ye]=(0,s.useState)(),[Fe,Ee]=(0,s.useState)(),[He,Qe]=(0,s.useState)([]),[Ge,Le]=(0,s.useState)({}),[Ke,Ve]=(0,s.useState)(),{formatMessage:Je}=(0,N.A)();return(0,R.jsxs)("div",{dir:"en"===localStorage.getItem("language")?"ltr":"rtl",className:"container rounded-5 popup transition ".concat(re&&"sellpurchase"," ").concat(p?"show":""),style:{width:"95%",maxWidth:"95%",height:"85vh",backgroundColor:"#f8f9fa",padding:"5px",fontSize:"0.8rem"},children:[(0,R.jsxs)(y.A,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"center",mt:1},children:[(0,R.jsx)(f.A,{variant:"h6",sx:{textAlign:"center",borderRadius:1,p:.5,color:"white",width:"100%",fontSize:"0.9rem",bgcolor:"info.main"},children:(0,R.jsx)(q.A,{id:"Purchase Return"})}),(0,R.jsx)(S.A,{size:"small",className:"hover_btn",onClick:B,"aria-label":"Close",children:(0,R.jsx)(W.A,{size:16})})]}),(0,R.jsx)(y.A,{sx:{p:.5,borderRadius:5},children:(0,R.jsxs)(y.A,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"}},children:[(0,R.jsxs)(y.A,{sx:{width:{xs:"100%",md:"66.66%"}},children:[(0,R.jsxs)(b.A,{elevation:1,sx:{p:1,mb:1,borderRadius:3,px:2},children:[(0,R.jsx)(f.A,{variant:"subtitle2",sx:{mt:.5,mb:1,fontSize:"0.85rem"},children:(0,R.jsx)(q.A,{id:"Search Bill"})}),(0,R.jsxs)(y.A,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"}},children:[(0,R.jsxs)(y.A,{sx:{width:"25%",mr:1},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Bill Number"})}),(0,R.jsx)(v.A,{onChange:e=>Ee(e.target.value),value:Fe,type:"number",size:"small",fullWidth:!0,sx:{mb:1,"& .MuiInputBase-input":{fontSize:"0.8rem",py:.5}}})]}),(0,R.jsx)(w.A,{onClick:()=>{Fe?i.A.get(l.A.getAddress()+"/api/purchase/"+Fe,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))}}).then(e=>{Ve(e.data.money),Le(e.data.bill),Qe(e.data.purchase)}).catch(()=>{Le([]),Qe([]),L({position:"top-end",icon:"error",title:(0,R.jsx)(q.A,{id:"This bill number not found!"}),showConfirmButton:!1,timer:1e3})}):L({position:"top-end",icon:"error",title:(0,R.jsx)(q.A,{id:"Please fill the bill number!"}),showConfirmButton:!1,timer:1e3})},variant:"contained",color:"success",size:"small",sx:{width:"6rem",fontSize:"0.8rem",height:"2rem",mt:3,mx:1},children:(0,R.jsx)(q.A,{id:"Find Bill"})}),(0,R.jsxs)(y.A,{sx:{width:"25%",ml:1},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Customer Name"})}),(0,R.jsx)(v.A,{readOnly:!0,value:(null==Ge?void 0:Ge.temp_customer)||(null===(t=Ge.accounts)||void 0===t?void 0:t.account.name),size:"small",fullWidth:!0,sx:{mb:1,"& .MuiInputBase-input":{fontSize:"0.8rem",py:.5}}})]})]})]}),(0,R.jsxs)(b.A,{elevation:1,sx:{p:1,mb:1,borderRadius:3,px:2},children:[(0,R.jsx)(f.A,{variant:"subtitle2",sx:{mt:.5,mb:1,fontSize:"0.85rem"},children:(0,R.jsx)(q.A,{id:"Customer Info"})}),(0,R.jsxs)(y.A,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"}},children:[(0,R.jsxs)(y.A,{sx:{width:"100%",mr:1},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Date"})}),(0,R.jsx)(v.A,{readOnly:!0,value:(null==Ge?void 0:Ge.dateInsert)&&(e=>{const t=new Date(e);let n="".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"),"-").concat(String(t.getDate()).padStart(2,"0"));const i=t.getHours(),s=t.getMinutes();let a=i>=12?"pm":"am";const l=i%12||12,o=s<10?"0"+s:s;return"Persian"===localStorage.getItem("date")?(d().locale("fa"),a=i>=12?"ب.ظ":"ق.ظ",n=d()(e).format("jYYYY-jMM-jDD")):d().locale("en"),"".concat(n," ").concat(l,":").concat(o," ").concat(a)})(null==Ge?void 0:Ge.dateInsert),size:"small",fullWidth:!0,sx:{mb:1,"& .MuiInputBase-input":{fontSize:"0.8rem",py:.5}}})]}),(0,R.jsxs)(y.A,{sx:{width:"100%",mr:1},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Total Amount"})}),(0,R.jsx)(v.A,{readOnly:!0,value:(null==Ge?void 0:Ge.total)&&String(null==Ge?void 0:Ge.total)+" "+(null===(n=Ge.money)||void 0===n?void 0:n.name),size:"small",fullWidth:!0,sx:{mb:1,"& .MuiInputBase-input":{fontSize:"0.8rem",py:.5}}})]}),(0,R.jsxs)(y.A,{sx:{width:"100%",mr:1},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Paid Amount"})}),(0,R.jsx)(v.A,{readOnly:!0,value:(null==Ge?void 0:Ge.PaidAmount)&&(null==Ge?void 0:Ge.PaidAmount)+" "+(null===(a=Ge.money)||void 0===a?void 0:a.name),size:"small",fullWidth:!0,sx:{mb:1,"& .MuiInputBase-input":{fontSize:"0.8rem",py:.5}}})]}),(0,R.jsxs)(y.A,{sx:{width:"100%"},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Remain Amount"})}),(0,R.jsx)(v.A,{readOnly:!0,value:(null==Ge?void 0:Ge.Remain)&&(null==Ge?void 0:Ge.Remain)+" "+(null===(r=Ge.money)||void 0===r?void 0:r.name),size:"small",fullWidth:!0,sx:{mb:1,"& .MuiInputBase-input":{fontSize:"0.8rem",py:.5}}})]})]})]}),(0,R.jsxs)(b.A,{elevation:1,sx:{p:1,mb:.5,borderRadius:3,px:2},children:[(0,R.jsx)(f.A,{variant:"subtitle2",sx:{mt:.5,mb:1,fontSize:"0.85rem"},children:(0,R.jsx)(q.A,{id:"Item information"})}),(0,R.jsxs)(y.A,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:1,mb:.5},children:[(0,R.jsxs)(y.A,{sx:{flex:"1 1 200px",minWidth:"180px"},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Item Name"})}),(0,R.jsx)(g.A,{searchQuery:ke,setSearchQuery:Pe,handleInputChange:e=>{Pe(e),Ce()},handleSearch:Ce,setSelectedOption:e=>{ae(e),e&&ge((0,x.A)((0,x.A)({},Ae),{},{stocks_id:e.stocks_id,stock:e,purchase:e.id}))},selectedOption:se,options:He,compactMode:!0})]}),(0,R.jsxs)(y.A,{sx:{flex:"1 1 120px",minWidth:"120px"},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Quantity"})}),(0,R.jsx)(M.HG,{customInput:v.A,onKeyDown:Re,onValueChange:e=>{let{value:t}=e;return _e({target:{name:"qty",value:t}})},value:Ae.qty,name:"qty",size:"small",fullWidth:!0,thousandSeparator:!0,sx:{"& .MuiInputBase-input":{fontSize:"0.8rem",py:.5}}})]}),(0,R.jsxs)(y.A,{sx:{flex:"1 1 150px",minWidth:"120px"},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Purchase Price"})}),(0,R.jsx)(M.HG,{customInput:v.A,onKeyDown:Re,onValueChange:e=>{let{value:t}=e;return _e({target:{name:"purchase_price",value:t}})},value:Ae.purchase_price,name:"purchase_price",size:"small",fullWidth:!0,thousandSeparator:!0,sx:{"& .MuiInputBase-input":{fontSize:"0.8rem",py:.5}}})]}),"gold"===(null===(c=X[0])||void 0===c?void 0:c.type)&&(0,R.jsxs)(y.A,{sx:{flex:"1 1 120px",minWidth:"120px"},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"weight"})}),(0,R.jsx)(M.HG,{customInput:v.A,onKeyDown:Re,thousandSeparator:!0,decimalSeparator:".",decimalScale:3,onValueChange:e=>{let{value:t}=e;return _e({target:{name:"weight",value:t}})},value:Ae.weight,name:"weight",size:"small",fullWidth:!0,thousandSeparator:!0,sx:{"& .MuiInputBase-input":{fontSize:"0.8rem",py:.5}}})]}),(0,R.jsxs)(y.A,{sx:{flex:"2 1 200px",minWidth:"180px"},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Description"})}),(0,R.jsx)(v.A,{name:"description",multiline:!0,minRows:1,size:"small",fullWidth:!0,sx:{fontSize:"0.8rem"},value:Ae.description,onChange:_e})]}),(0,R.jsx)(y.A,{sx:{display:"flex",alignItems:"flex-end"},children:(0,R.jsx)(w.A,{onClick:()=>{if(!Ae.qty)return void L({position:"top-end",icon:"error",title:(0,R.jsx)(q.A,{id:"Select an item!"}),showConfirmButton:!1,timer:1e3});const e=Ae.qty?parseInt(Ae.qty):0,t=Ae.weight?parseFloat(Ae.weight):1,n=Ae.purchase_price?parseInt(Ae.purchase_price):0;if(parseInt(se.qty)-e<0)return void L({position:"top-end",icon:"error",title:(0,R.jsx)(q.A,{id:"have not enuagh item!"}),showConfirmButton:!1,timer:1e3});if(!e||!n||!se)return void L({position:"top-end",icon:"error",title:(0,R.jsx)(q.A,{id:"Please select an item and fill the quantity and price!"}),showConfirmButton:!1,timer:1e3});if(e<=0||n<=0)return void L({position:"top-end",icon:"error",title:(0,R.jsx)(q.A,{id:"Quantity and price must be positive values!"}),showConfirmButton:!1,timer:1e3});const i=(0,x.A)((0,x.A)({},se),{purchase:Ae.purchase});Qe(e=>e.map(e=>{if(e.id===se.id){const t=parseInt(e.qty)-parseInt(Ae.qty);return(0,x.A)((0,x.A)({},e),{},{qty:t})}return e})),i.qty=Ae.qty,ye(e=>[...je,i]),Te(i=>i+e*n*t),Se(i=>i+e*n*t),ge({purchase:null,stocks_id:"",qty:"",weight:null,dateInsert:(new Date).toISOString(),rate:null,user_id:localStorage.getItem("userTokenid"),purchase_price:"",description:"",sell_price:"",expiry_date:(new Date).toISOString(),accounts_id:"",money:"",stock:{name:""},e_id:Ae.e_id+1}),ae(null)},variant:"contained",color:"success",size:"small",sx:{width:"5rem",fontSize:"0.8rem",height:"2rem",mb:1,mt:{xs:1,sm:4}},children:(0,R.jsx)(k.A,{size:15})})})]})]})]}),(0,R.jsxs)(y.A,{sx:{width:{xs:"100%",md:"33.33%"},ml:{md:1}},children:[(0,R.jsxs)(y.A,{sx:{m:.5,mt:0,maxHeight:"200px",overflow:"auto",height:"200px"},children:[(0,R.jsx)(f.A,{variant:"subtitle1",sx:{textAlign:"center",borderRadius:1,p:.5,color:"white",mb:.5,fontSize:"0.85rem",bgcolor:"info.main"},children:(0,R.jsx)(q.A,{id:"Item Sold"})}),(0,R.jsxs)(_.A,{size:"small",sx:{fontSize:"0.8rem"},children:[(0,R.jsx)(I.A,{children:(0,R.jsxs)(z.A,{children:[(0,R.jsx)(C.A,{sx:{width:"30%"},children:(0,R.jsx)(q.A,{id:"Name"})}),(0,R.jsx)(C.A,{sx:{width:"20%"},children:(0,R.jsx)(q.A,{id:"Quantity"})}),"gold"===X[0].type&&(0,R.jsx)(C.A,{sx:{width:"10%"},children:(0,R.jsx)(q.A,{id:"weight"})}),(0,R.jsx)(C.A,{sx:{width:"25%"},children:(0,R.jsx)(q.A,{id:"Price"})}),(0,R.jsx)(C.A,{sx:{width:"25%"},children:(0,R.jsx)(q.A,{id:"Description"})})]})}),(0,R.jsx)(D.A,{children:null==He?void 0:He.map((e,t)=>(0,R.jsxs)(z.A,{children:[(0,R.jsx)(C.A,{children:e.stock.name}),(0,R.jsx)(C.A,{children:e.qty}),"gold"===X[0].type&&(0,R.jsx)(C.A,{children:e.weight}),(0,R.jsx)(C.A,{children:e.purchase_price}),(0,R.jsx)(C.A,{children:e.description})]},t))})]})]}),(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Total Return Amount"})}),(0,R.jsx)(v.A,{readOnly:!0,value:fe,size:"small",fullWidth:!0,sx:{mb:1,"& .MuiInputBase-input":{fontSize:"0.8rem",py:.5}}}),(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Paid Return Amount"})}),(0,R.jsx)(v.A,{readOnly:!Oe,onChange:e=>{Te(e.target.value)},value:Be,size:"small",fullWidth:!0,sx:{mb:1,"& .MuiInputBase-input":{fontSize:"0.8rem",py:.5}}}),(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Remain Return Amount"})}),(0,R.jsx)(v.A,{readOnly:!0,value:ce.belance,type:"number",size:"small",fullWidth:!0,sx:{mb:1,"& .MuiInputBase-input":{fontSize:"0.8rem",py:.5}}})]})]})}),(0,R.jsxs)(y.A,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},m:0,p:0},children:[(0,R.jsx)(y.A,{sx:{width:{xs:"100%",md:"66.66%"}},children:(0,R.jsxs)(y.A,{sx:{maxHeight:"300px",overflow:"auto"},children:[(0,R.jsx)(f.A,{variant:"subtitle1",sx:{textAlign:"center",borderRadius:1,p:.5,color:"white",mb:.5,fontSize:"0.85rem",bgcolor:"info.main"},children:(0,R.jsx)(q.A,{id:"Return Item Sold"})}),(0,R.jsxs)(_.A,{size:"small",sx:{fontSize:"0.8rem"},children:[(0,R.jsx)(I.A,{children:(0,R.jsxs)(z.A,{children:[(0,R.jsx)(C.A,{sx:{width:"5%"},children:(0,R.jsx)(q.A,{id:"No"})}),(0,R.jsx)(C.A,{sx:{width:"20%"},children:(0,R.jsx)(q.A,{id:"Name"})}),(0,R.jsx)(C.A,{sx:{width:"15%"},children:(0,R.jsx)(q.A,{id:"Quantity"})}),"gold"===X[0].type&&(0,R.jsx)(C.A,{sx:{width:"10%"},children:(0,R.jsx)(q.A,{id:"weight"})}),(0,R.jsx)(C.A,{sx:{width:"15%"},children:(0,R.jsx)(q.A,{id:"Price"})}),(0,R.jsx)(C.A,{sx:{width:"15%"},children:(0,R.jsx)(q.A,{id:"Total"})}),(0,R.jsx)(C.A,{sx:{width:"20%"},children:(0,R.jsx)(q.A,{id:"Description"})}),(0,R.jsx)(C.A,{sx:{width:"10%"},children:(0,R.jsx)(q.A,{id:"Delete"})})]})}),(0,R.jsx)(D.A,{children:null==je?void 0:je.map((e,t)=>(0,R.jsxs)(z.A,{children:[(0,R.jsx)(C.A,{children:e.e_id}),(0,R.jsx)(C.A,{children:e.stock.name}),(0,R.jsx)(C.A,{children:e.qty}),"gold"===X[0].type&&(0,R.jsx)(C.A,{children:e.weight}),(0,R.jsx)(C.A,{children:e.purchase_price}),(0,R.jsx)(C.A,{children:e.purchase_price*e.qty}),(0,R.jsx)(C.A,{children:e.description}),(0,R.jsx)(C.A,{children:(0,R.jsx)(S.A,{size:"small",onClick:()=>{return t=e,Qe(e=>e.map(e=>e.id===t.purchase?(0,x.A)((0,x.A)({},e),{},{qty:e.qty+t.qty}):e)),Se(e=>e-t.qty*t.sell_price*t.weight),Te(e=>e-t.qty*t.sell_price*t.weight),void ye(e=>e.filter(e=>e.e_id!==t.e_id));var t},children:(0,R.jsx)(P.A,{size:15})})})]},t))})]})]})}),(0,R.jsxs)(y.A,{sx:{width:{xs:"100%",md:"33.33%"}},children:[(0,R.jsx)(y.A,{className:"date-picker-container",children:(0,R.jsx)(h.A,{default_value:le,handle_date:e=>{if(e){const{year:t,month:n,day:i}=e,s=(A().toGregorian(t,n,i),new Date);String(s.getHours()).padStart(2,"0"),String(s.getMinutes()).padStart(2,"0");const a=new Date,l=new Date(e.year,e.month-1,e.day,a.getHours(),a.getMinutes()).toISOString();ge((0,x.A)((0,x.A)({},Ae),{},{dateInsert:l}))}},lebal:(0,R.jsx)(q.A,{id:"Date"}),setSelectedDay:te,selectedDay:ee,compactMode:!0})}),(0,R.jsxs)(y.A,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},justifyContent:"center",mt:1},children:[(0,R.jsx)(w.A,{variant:"contained",color:"error",size:"small",sx:{width:"120px",fontSize:"0.8rem",py:.5,mb:.5,mr:{md:.5},ml:.5},onClick:B,children:(0,R.jsx)(q.A,{id:"Cancel"})}),(0,R.jsx)(w.A,{variant:"contained",color:"success",size:"small",sx:{width:"120px",fontSize:"0.8rem",py:.5,mb:.5,mr:{md:.5},ml:.5},onClick:()=>we(!1),children:(0,R.jsx)(q.A,{id:"Save"})}),(0,R.jsx)(w.A,{variant:"contained",color:"success",size:"small",sx:{width:"120px",fontSize:"0.8rem",py:.5,mb:.5,ml:.5},onClick:()=>we(!0),children:(0,R.jsx)(q.A,{id:"Print And Save"})})]})]})]})]})}function T(e){var t,n,a,r,c,p,B;let{AddSellModal:T,close:O,records:Y,setRecords:F,moneys:E,shopingcart:H,setshopingcart:Q,belance:G,setbelance:L,setAddBalanceModal:K,options1:V,setOptions1:J,SoldRecords:U,setSoldRecords:X,bill:Z,setbill:$,money:ee,setmoney:te,returnbill:ne,setreturnbill:ie,TotalAmount:se,setTotalAmount:ae,PaidAmount:le,setPaidAmount:oe}=e;const re=(0,o.N)(),de=(0,m.wA)(),{settings:ce,errors:ue,statuss:me}=(0,m.d4)(e=>e.settings),{sidebars:xe}=(0,m.d4)(e=>e.sidebars);(0,s.useEffect)(()=>{me||0!==(null==ce?void 0:ce.lenght)||de((0,u.mt)())},[de,me]);const{items:he,errori:pe}=(0,m.d4)(e=>e.items),[Ae,ge]=(0,s.useState)(d()()),[je,ye]=(0,s.useState)(),[fe,Se]=(0,s.useState)(),[be,ve]=(0,s.useState)(d()()),[we,_e]=(0,s.useState)(!1),[Ie,ze]=(0,s.useState)({id:0,belance:0}),[Ce,De]=(0,s.useState)([]),[We,ke]=(0,s.useState)(0),[Pe,Me]=(0,s.useState)({purchase:null,stocks_id:"",qty:null,weight:null,dateInsert:(new Date).toISOString(),rate:null,user_id:localStorage.getItem("userTokenid"),purchase_price:null,description:"",sell_price:null,expiry_date:(new Date).toISOString(),accounts_id:"",money:"",stock:{name:""},e_id:1}),[qe,Ne]=(0,s.useState)(0),Re=e=>{var t;let n=0,s=[];H.forEach(e=>{s.push({purchase:e.purchase,stocks_id:e.stocks_id,qty:parseInt(e.qty),weight:e.weight,dateInsert:e.dateInsert,rate:e.rate,user_id:e.user_id,purchase_price:e.purchase_price,description:e.description,expiry_date:e.expiry_date,bill_id:"",accounts_id:e.accounts_id})});let a={arr:s,_method:"put"};i.A.post(l.A.getAddress()+"/api/purchasereturn/"+ne.id,a,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))},params:{Exesting:null!=Z&&Z.accounts_id?"ok":"no",money:(null==Z?void 0:Z.money_id)||0,accounts_id:null===(t=Z.accounts)||void 0===t?void 0:t.account_id,PaidAmount:le||0,TotalAmount:se,CustomerName:Z.temp_customer,DateInsert:Ae,bill_id:Z.id}}).then(t=>{var i;e&&(e=>{const t=new j.default;t.setFontSize(26),t.setFont("helvetica","bold"),t.setTextColor(11,105,255),t.text("Invoice",105,10,null,null,"center"),t.setFontSize(14),t.setFont("helvetica","normal"),t.setTextColor(0,0,0),t.text("".concat(ce[0].company_name),105,20,null,null,"center"),t.setFontSize(12),t.text("Seller Name: ".concat(je?je.name.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"N/A"),105,28,null,null,"center"),t.setFontSize(14),t.setTextColor(11,105,255),t.text("Invoice Number: ".concat(e),5,19),t.setFontSize(12),t.setTextColor(0,0,0);const n=new Date(Ae);let i="".concat(n.getFullYear(),"-").concat(String(n.getMonth()+1).padStart(2,"0"),"-").concat(String(n.getDate()).padStart(2,"0"));const s=n.getHours(),a=n.getMinutes();let o=s>=12?"pm":"am";const r=s%12||12,c=a<10?"0"+a:a;"Persian"===localStorage.getItem("date")?(d().locale("fa"),o=s>=12?"pm":"am",i=d()(Ae).format("jYYYY/jMM/jDD")):d().locale("en");const u="".concat(i," ").concat(r,":").concat(c," ").concat(o);if(t.text("Date:".concat(u),5,29),t.setDrawColor(0,0,0),t.setLineWidth(.5),t.line(5,35,205,35),ce[0].company_pic){const e=ce[0].company_pic.split("/").pop();t.addImage(l.A.getAddress()+"/api/getImage/"+e,"JPEG",180,5,25,25)}else t.setFontSize(12),t.text("No Company Image Available",150,20);t.autoTable({startY:40,head:[["No","Name","Quantity","Price","Total"]],body:H.map(e=>[e.e_id,e.stock.name,e.qty,e.sell_price+"".concat(Ge?Ge.name:"N/A"),e.sell_price*e.qty+"".concat(Ge?Ge.name:"N/A")]),theme:"grid",headStyles:{fillColor:[11,105,255],textColor:[255,255,255],fontSize:10,fontStyle:"bold"},bodyStyles:{fontSize:10,textColor:[0,0,0],fillColor:[255,255,255]},alternateRowStyles:{fillColor:[245,245,245]}});const m=t.lastAutoTable.finalY||40;t.setFontSize(9),t.setTextColor(0,0,0),t.text("Total Amount: ".concat(se)+"".concat(Ge?Ge.name:"N/A"),152,m+5),t.text("Paid Amount: ".concat(le||"0.00")+"".concat(Ge?Ge.name:"N/A"),152,m+10),t.text("Belance: ".concat(Ie.belance)+"".concat(Ge?Ge.name:"N/A"),152,m+15),m+15>144?(t.setDrawColor(0,0,0),t.setLineWidth(.5),t.line(5,278,205,278),t.text("Address: ".concat(ce[0].address),10,283),t.text("Phone: ".concat(ce[0].phone),80,283),t.text("Email: ".concat(ce[0].email),140,283)):(t.setDrawColor(0,0,0),t.setLineWidth(.5),t.line(5,139,205,139),t.setFontSize(12),t.text("Address: ".concat(ce[0].address),10,144),t.text("Phone: ".concat(ce[0].phone),80,144),t.text("Email: ".concat(ce[0].email),140,144));const x=t.output("bloburl"),h=document.createElement("iframe");h.style.display="none",h.src=x,document.body.appendChild(h),h.contentWindow.print()})(t.data.bill.id),t.data.bill.money=ee,t.data.bill.accounts={account:null==Z||null===(i=Z.accounts)||void 0===i?void 0:i.account},t.data.bill.temp_customer=Z.temp_customer,n=t.data.bill.id;t.data.bill;ge(d()()),ye({name:""}),Se({name:"",type:{measuring:""}}),ve(d()()),Ne(0),Me({stocks_id:0,qty:0,weight:0,dateInsert:(new Date).toISOString(),rate:0,user_id:localStorage.getItem("userTokenid"),purchase_price:0,description:"Description",sell_price:0,expiry_date:(new Date).toISOString(),accounts_id:""}),Ee(""),Qe(""),Le({name:""}),_e(!1),ge(d()()),ye(),Le(),ke(0),re({position:"top-end",icon:"success",title:"Stock has been created!",showConfirmButton:!1,timer:1e3})}).catch(e=>{re({position:"top-end",icon:"error",title:"Sosmething went wrong!",showConfirmButton:!1,timer:1e3})})},Be=e=>{Me((0,x.A)((0,x.A)({},Pe),{},{[e.target.name]:e.target.value}))},[Te,Oe]=(0,s.useState)(),Ye=async e=>{},[Fe,Ee]=(0,s.useState)(""),[He,Qe]=(0,s.useState)(""),[Ge,Le]=(0,s.useState)({name:""}),Ke=(0,s.useRef)(null),Ve=e=>{"Enter"===e.key&&(e.preventDefault(),Ke.current&&T&&Ke.current.click())},Je=e=>{oe(e.target.value)};(0,s.useEffect)(()=>{ze(le?e=>(0,x.A)((0,x.A)({},e),{},{belance:le-se||0}):e=>(0,x.A)((0,x.A)({},e),{},{belance:-se}))},[le,se,H]);const[Ue,Xe]=(0,s.useState)(),[Ze,$e]=(0,s.useState)();const{formatMessage:et}=(0,N.A)();return(0,R.jsxs)("div",{dir:"en"===localStorage.getItem("language")?"ltr":"rtl",className:"container rounded-5 popup transition ".concat(we&&"sellpurchase"," ").concat(T?"show":""),style:{width:"95%",maxWidth:"95%",height:"85vh",backgroundColor:"#f8f9fa",padding:"5px",fontSize:"0.8rem",overflowY:"auto"},children:[(0,R.jsxs)(y.A,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"center",mt:1},children:[(0,R.jsx)(f.A,{variant:"h6",sx:{textAlign:"center",borderRadius:1,p:.5,color:"white",width:"100%",fontSize:"0.9rem",bgcolor:"info.main"},children:(0,R.jsx)(q.A,{id:"Purchase Return"})}),(0,R.jsx)(S.A,{size:"small",className:"hover_btn",onClick:O,children:(0,R.jsx)(W.A,{size:16})})]}),(0,R.jsx)(y.A,{sx:{p:.5,borderRadius:5},children:(0,R.jsxs)(y.A,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"}},children:[(0,R.jsxs)(y.A,{sx:{width:{xs:"100%",md:"66.66%"}},children:[(0,R.jsxs)(b.A,{elevation:1,sx:{p:1,mb:1,borderRadius:3,px:2},children:[(0,R.jsx)(f.A,{variant:"subtitle2",sx:{mb:1,fontSize:"0.85rem"},children:(0,R.jsx)(q.A,{id:"Search Bill"})}),(0,R.jsxs)(y.A,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:1},children:[(0,R.jsxs)(y.A,{sx:{flex:1},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Bill Number"})}),(0,R.jsx)(v.A,{onChange:e=>$e(e.target.value),value:Z.id||"",type:"number",size:"small",fullWidth:!0})]}),(0,R.jsxs)(y.A,{sx:{flex:1},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Customer Name"})}),(0,R.jsx)(v.A,{readOnly:!0,value:(null==Z?void 0:Z.temp_customer)||(null===(t=Z.accounts)||void 0===t?void 0:t.account.name),size:"small",fullWidth:!0})]})]})]}),(0,R.jsxs)(b.A,{elevation:1,sx:{p:1,mb:1,borderRadius:3,px:2},children:[(0,R.jsx)(f.A,{variant:"subtitle2",sx:{mb:1,fontSize:"0.85rem"},children:(0,R.jsx)(q.A,{id:"Customer Info"})}),(0,R.jsx)(y.A,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:[{label:"Date",value:(null==Z?void 0:Z.dateInsert)&&(e=>{const t=new Date(e);let n="".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"),"-").concat(String(t.getDate()).padStart(2,"0"));const i=t.getHours(),s=t.getMinutes();let a=i>=12?"pm":"am";const l=i%12||12,o=s<10?"0"+s:s;return"Persian"===ce[0].date?(d().locale("fa"),a=i>=12?"ب.ظ":"ق.ظ",n=d()(e).format("jYYYY-jMM-jDD")):d().locale("en"),"".concat(n," ").concat(l,":").concat(o," ").concat(a)})(null==Z?void 0:Z.dateInsert)},{label:"Total Amount",value:(null==Z?void 0:Z.total)&&"".concat(null==Z?void 0:Z.total," ").concat(null===(n=Z.money)||void 0===n?void 0:n.name)},{label:"Paid Amount",value:(null==Z?void 0:Z.PaidAmount)&&"".concat(null==Z?void 0:Z.PaidAmount," ").concat(null===(a=Z.money)||void 0===a?void 0:a.name)},{label:"Remain Amount",value:(null==Z?void 0:Z.Remain)&&"".concat(null==Z?void 0:Z.Remain," ").concat(null===(r=Z.money)||void 0===r?void 0:r.name)}].map((e,t)=>(0,R.jsxs)(y.A,{sx:{flex:"1 1 45%"},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:e.label})}),(0,R.jsx)(v.A,{readOnly:!0,value:e.value,size:"small",fullWidth:!0})]},t))})]}),(0,R.jsxs)(b.A,{elevation:1,sx:{p:1,mb:.5,borderRadius:3,px:2},children:[(0,R.jsx)(f.A,{variant:"subtitle2",sx:{mt:.5,mb:1,fontSize:"0.85rem"},children:(0,R.jsx)(q.A,{id:"Item information"})}),(0,R.jsxs)(y.A,{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",gap:1,mb:.5},children:[(0,R.jsxs)(y.A,{sx:{flex:"1 1 200px",minWidth:"180px"},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Item Name"})}),(0,R.jsx)(g.A,{searchQuery:He,setSearchQuery:Qe,handleInputChange:e=>{Qe(e),Ye()},handleSearch:Ye,setSelectedOption:e=>{Se(e),e&&Me((0,x.A)((0,x.A)({},Pe),{},{stocks_id:e.stocks_id,stock:e,purchase:e.id}))},selectedOption:fe,options:U,compactMode:!0})]}),(0,R.jsxs)(y.A,{sx:{flex:"1 1 120px",minWidth:"120px"},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Quantity"})}),(0,R.jsx)(M.HG,{customInput:v.A,onKeyDown:Ve,onValueChange:e=>{let{value:t}=e;return Be({target:{name:"qty",value:t}})},value:Pe.qty,name:"qty",size:"small",fullWidth:!0,thousandSeparator:!0,sx:{"& .MuiInputBase-input":{fontSize:"0.8rem",py:.5}}})]}),(0,R.jsxs)(y.A,{sx:{flex:"1 1 150px",minWidth:"120px"},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Purchase Price"})}),(0,R.jsx)(M.HG,{customInput:v.A,onKeyDown:Ve,onValueChange:e=>{let{value:t}=e;return Be({target:{name:"purchase_price",value:t}})},value:Pe.purchase_price,name:"purchase_price",size:"small",fullWidth:!0,thousandSeparator:!0,sx:{"& .MuiInputBase-input":{fontSize:"0.8rem",py:.5}}})]}),"gold"===(null===(c=xe[0])||void 0===c?void 0:c.type)&&(0,R.jsxs)(y.A,{sx:{flex:"1 1 120px",minWidth:"120px"},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"weight"})}),(0,R.jsx)(M.HG,{customInput:v.A,onKeyDown:Ve,thousandSeparator:!0,decimalSeparator:".",decimalScale:3,onValueChange:e=>{let{value:t}=e;return Be({target:{name:"weight",value:t}})},value:Pe.weight,name:"weight",size:"small",fullWidth:!0,sx:{"& .MuiInputBase-input":{fontSize:"0.8rem",py:.5}}})]}),(0,R.jsxs)(y.A,{sx:{flex:"2 1 200px",minWidth:"180px"},children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:"Description"})}),(0,R.jsx)(v.A,{name:"description",multiline:!0,minRows:1,size:"small",fullWidth:!0,sx:{fontSize:"0.8rem"},value:Pe.description,onChange:Be})]}),(0,R.jsx)(y.A,{sx:{display:"flex",alignItems:"flex-end"},children:(0,R.jsx)(w.A,{onClick:()=>{if(!Pe.qty)return void re({position:"top-end",icon:"error",title:"Select an item!",showConfirmButton:!1,timer:1e3});const e=parseInt(Pe.qty)||0,t=Pe.weight||1,n=parseInt(Pe.purchase_price)||0;if(parseInt(fe.qty)-e<0)return void re({position:"top-end",icon:"error",title:"Not enough items!",showConfirmButton:!1,timer:1e3});if(!e||!n||!fe)return void re({position:"top-end",icon:"error",title:"Please select an item and fill the quantity and price!",showConfirmButton:!1,timer:1e3});if(e<=0||n<=0)return void re({position:"top-end",icon:"error",title:"Quantity and price must be positive values!",showConfirmButton:!1,timer:1e3});const i=(0,x.A)((0,x.A)({},fe),{},{purchase_price:Pe.purchase_price,qty:e});X(t=>t.map(t=>{if(t.id===fe.id&&t.qty>=e){const n=parseInt(t.qty-e);return(0,x.A)((0,x.A)({},t),{},{qty:n})}return t}));let s=H.length>0?H[H.length-1].id+1:1;i.id=s,Q(e=>[...e,i]),oe(i=>i+e*n*t),ae(i=>i+e*n*t),Me({stocks_id:"",qty:"",weight:null,dateInsert:(new Date).toISOString(),rate:null,user_id:localStorage.getItem("userTokenid"),purchase_price:"",description:"",sell_price:"",expiry_date:(new Date).toISOString(),accounts_id:"",money:"",stock:{name:""},id:null}),Se(null)},variant:"contained",color:"success",size:"small",sx:{width:"5rem",fontSize:"0.8rem",height:"2rem",mb:1,mt:{xs:1,sm:4}},children:(0,R.jsx)(k.A,{size:15})})})]})]})]}),(0,R.jsxs)(y.A,{sx:{width:{xs:"100%",md:"33.33%"},ml:{md:1}},children:[(0,R.jsxs)(y.A,{sx:{maxHeight:200,overflowX:"auto",overflowY:"auto"},children:[(0,R.jsx)(f.A,{variant:"subtitle1",sx:{textAlign:"center",bgcolor:"info.main",color:"white",fontSize:"0.85rem"},children:(0,R.jsx)(q.A,{id:"Item Sold"})}),(0,R.jsxs)(_.A,{size:"small",sx:{minWidth:600},children:[(0,R.jsx)(I.A,{children:(0,R.jsxs)(z.A,{children:[(0,R.jsx)(C.A,{children:(0,R.jsx)(q.A,{id:"Name"})}),(0,R.jsx)(C.A,{children:(0,R.jsx)(q.A,{id:"Quantity"})}),"gold"===(null===(p=xe[0])||void 0===p?void 0:p.type)&&(0,R.jsx)(C.A,{sx:{width:"10%"},children:(0,R.jsx)(q.A,{id:"weight"})}),(0,R.jsx)(C.A,{children:(0,R.jsx)(q.A,{id:"Price"})}),(0,R.jsx)(C.A,{children:(0,R.jsx)(q.A,{id:"Description"})})]})}),(0,R.jsx)(D.A,{children:null==U?void 0:U.map((e,t)=>{var n;return(0,R.jsxs)(z.A,{children:[(0,R.jsx)(C.A,{children:e.stock.name}),(0,R.jsx)(C.A,{children:e.qty}),"gold"===(null===(n=xe[0])||void 0===n?void 0:n.type)&&(0,R.jsx)(C.A,{children:e.weight}),(0,R.jsx)(C.A,{children:e.purchase_price}),(0,R.jsx)(C.A,{children:e.description})]},t)})})]})]}),[["Total Return Amount",se],["Paid Return Amount",le],["Remain Return Amount",Ie.belance]].map((e,t)=>{let[n,i]=e;return(0,R.jsxs)(y.A,{children:[(0,R.jsx)(f.A,{fontWeight:"bold",variant:"body2",children:(0,R.jsx)(q.A,{id:n})}),(0,R.jsx)(v.A,{readOnly:"Paid Return Amount"!==n||!Ue,onChange:"Paid Return Amount"===n?Je:void 0,value:i,size:"small",fullWidth:!0})]},t)})]})]})}),(0,R.jsxs)(y.A,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},gap:1},children:[(0,R.jsxs)(y.A,{sx:{width:{xs:"100%",md:"66.66%"},maxHeight:300,overflow:"auto"},children:[(0,R.jsx)(f.A,{variant:"subtitle1",sx:{textAlign:"center",bgcolor:"info.main",color:"white",fontSize:"0.85rem"},children:(0,R.jsx)(q.A,{id:"Return Item Sold"})}),(0,R.jsxs)(_.A,{size:"small",sx:{minWidth:800},children:[(0,R.jsx)(I.A,{children:(0,R.jsxs)(z.A,{children:[(0,R.jsx)(C.A,{children:(0,R.jsx)(q.A,{id:"No"})}),(0,R.jsx)(C.A,{children:(0,R.jsx)(q.A,{id:"Name"})}),(0,R.jsx)(C.A,{children:(0,R.jsx)(q.A,{id:"Quantity"})}),"gold"===(null===(B=xe[0])||void 0===B?void 0:B.type)&&(0,R.jsx)(C.A,{sx:{width:"10%"},children:(0,R.jsx)(q.A,{id:"weight"})}),(0,R.jsx)(C.A,{children:(0,R.jsx)(q.A,{id:"Price"})}),(0,R.jsx)(C.A,{children:(0,R.jsx)(q.A,{id:"Total"})}),(0,R.jsx)(C.A,{children:(0,R.jsx)(q.A,{id:"Description"})}),(0,R.jsx)(C.A,{children:(0,R.jsx)(q.A,{id:"Delete"})})]})}),(0,R.jsx)(D.A,{children:null==H?void 0:H.map((e,t)=>{var n;return(0,R.jsxs)(z.A,{children:[(0,R.jsx)(C.A,{children:e.e_id}),(0,R.jsx)(C.A,{children:e.stock.name}),(0,R.jsx)(C.A,{children:e.qty}),"gold"===(null===(n=xe[0])||void 0===n?void 0:n.type)&&(0,R.jsx)(C.A,{children:e.weight}),(0,R.jsx)(C.A,{children:e.purchase_price}),(0,R.jsx)(C.A,{children:e.purchase_price*e.qty}),(0,R.jsx)(C.A,{children:e.description}),(0,R.jsx)(C.A,{children:(0,R.jsx)(S.A,{size:"small",onClick:()=>{return t=e,X(e=>e.map(e=>e.id===t.purchase?(0,x.A)((0,x.A)({},e),{},{qty:e.qty+t.qty}):e)),ae(e=>parseInt(e)-parseInt(t.qty*t.purchase_price*t.weight)),oe(e=>parseInt(e)-parseInt(t.qty*t.purchase_price*t.weight)),void Q(e=>e.filter(e=>e.id!==t.id));var t},children:(0,R.jsx)(P.A,{size:15})})})]},t)})})]})]}),(0,R.jsxs)(y.A,{sx:{width:{xs:"100%",md:"33.33%"}},children:[(0,R.jsx)(y.A,{className:"date-picker-container",children:(0,R.jsx)(h.A,{default_value:be,handle_date:e=>{if(e){const{year:t,month:n,day:i}=e,s=(A().toGregorian(t,n,i),new Date);String(s.getHours()).padStart(2,"0"),String(s.getMinutes()).padStart(2,"0");const a=new Date,l=new Date(e.year,e.month-1,e.day,a.getHours(),a.getMinutes()).toISOString();Me((0,x.A)((0,x.A)({},Pe),{},{dateInsert:l}))}},lebal:(0,R.jsx)(q.A,{id:"Date"}),setSelectedDay:ge,selectedDay:Ae,compactMode:!0})}),(0,R.jsxs)(y.A,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},justifyContent:"center",mt:1,gap:1},children:[(0,R.jsx)(w.A,{variant:"contained",color:"error",size:"small",sx:{width:"120px"},onClick:O,children:(0,R.jsx)(q.A,{id:"Cancel"})}),(0,R.jsx)(w.A,{variant:"contained",color:"success",size:"small",sx:{width:"120px"},onClick:()=>Re(!1),children:(0,R.jsx)(q.A,{id:"Save"})}),(0,R.jsx)(w.A,{variant:"contained",color:"success",size:"small",sx:{width:"120px"},onClick:()=>Re(!0),children:(0,R.jsx)(q.A,{id:"Print And Save"})})]})]})]})]})}function O(){const e=(0,o.N)(),t=(0,m.wA)(),{moneys:n,errorm:r,statusm:x}=(0,m.d4)(e=>e.moneys),{belances:h,errorb:p,statusb:A}=(0,m.d4)(e=>e.belances),{customers:g,errorc:j,statusc:y}=(0,m.d4)(e=>e.customers),[f,S]=(0,s.useState)([]),[b,v]=(0,s.useState)(g),[w,_]=(0,s.useState)(h),[I,z]=(0,s.useState)([]),[C,D]=(0,s.useState)([]),[W,k]=(0,s.useState)(!1),[P,M]=(0,s.useState)(!1),[O,Y]=(0,s.useState)(!1),[F,E]=(0,s.useState)(!1),[H,Q]=(0,s.useState)(!1),[G,L]=(0,s.useState)([]),[K,V]=(0,s.useState)([]),[J,U]=(0,s.useState)([]),{items:X,errori:Z,statusi:$}=(0,m.d4)(e=>e.items),{settings:ee,errors:te,statuss:ne}=(0,m.d4)(e=>e.settings),[ie,se]=(0,s.useState)(),[ae,le]=(0,s.useState)([]),[oe,re]=(0,s.useState)({}),[de,ce]=(0,s.useState)();(0,s.useEffect)(()=>{ne||0!==(null==ee?void 0:ee.lenght)||t((0,u.mt)())},[t,ee,ne]);const[ue,me]=(0,s.useState)([]),[xe,he]=(0,s.useState)(0),[pe,Ae]=(0,s.useState)(!1),[ge,je]=(0,s.useState)(1),[ye,fe]=(0,s.useState)(10);(0,s.useEffect)(()=>{(async(e,t)=>{Ae(!0);try{const n=await i.A.get(l.A.getAddress()+"/api/purchasereturn",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))},params:{page:e,perPage:t,delete:0,product:"sell"}});D(n.data.data),he(n.data.total),Ae(!1)}catch(e){Ae(!1)}})(ge,ye)},[ge,ye]);const[Se,be]=(0,s.useState)([]),[ve,we]=(0,s.useState)(0),[_e,Ie]=(0,s.useState)(0),[ze,Ce]=(0,s.useState)(),[De,We]=(0,s.useState)(window.innerWidth>768),ke=[{name:"Id",selector:e=>e.bill.id,sortable:!0,style:{width:"1px",minWidth:"1px"}},{name:"Name",selector:e=>{var t;return null!==(t=e.bill.accounts)&&void 0!==t&&t.account?e.bill.accounts.account.name:e.bill.temp_customer},sortable:!0,style:{width:"1px",minWidth:"1px"}},{name:(0,R.jsx)("strong",{style:{minWidth:"200px",maxWidth:"240px",width:"240px"},children:"Date Created"}),selector:e=>(e=>{const t=new Date(e);let n="".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"),"-").concat(String(t.getDate()).padStart(2,"0"));const i=t.getHours(),s=t.getMinutes();let a=i>=12?"pm":"am";const l=i%12||12,o=s<10?"0"+s:s;return"Persian"===localStorage.getItem("date")?(d().locale("fa"),a=i>=12?"ب.ظ":"ق.ظ",n=d()(e).format("jYYYY-jMM-jDD")):d().locale("en"),"".concat(n," ").concat(l,":").concat(o," ").concat(a)})(e.bill.dateInsert)},{name:"Currency",selector:e=>{var t,n;return null===(t=e.bill)||void 0===t||null===(n=t.money)||void 0===n?void 0:n.name},sortable:!0},{name:"Total Amount",selector:e=>e.bill.total,sortable:!0},{name:"Paid Amount",selector:e=>e.bill.PaidAmount,sortable:!0},{name:"Rmain Amount",selector:e=>e.bill.Remain,sortable:!0},{name:(0,R.jsx)("strong",{style:{textAlign:"center",backgroundColor:"tranceparent",width:"100%"},children:"Show"}),selector:t=>(0,R.jsx)("button",{onClick:n=>{U(t.sells),we(t.bill.total),Ie(t.bill.PaidAmount),Ce(t.bill),(t=>{t?i.A.get(l.A.getAddress()+"/api/purchase/"+t,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))}}).then(e=>{qe(e.data.money),re(e.data.bill),le(e.data.purchase)}).catch(t=>{re([]),le([]),e({position:"top-end",icon:"error",title:"This bill number not found!",showConfirmButton:!1,timer:1e3})}):e({position:"top-end",icon:"error",title:"Please fill the bill number!",showConfirmButton:!1,timer:1e3})})(t.bill.bill_purchase),Q(!0)},style:{border:"none",backgroundColor:"transparent",height:"100%"},children:(0,R.jsx)("img",{height:"15%",width:"15%",src:c,style:{backgroundColor:"tranceparent"}})})}],Pe=(0,s.useMemo)(()=>{let e;return e="pa"===localStorage.getItem("language")||"da"===localStorage.getItem("language")?[...ke]:ke,e},[De]),[Me,qe]=(0,s.useState)([]),[Ne,Re]=(0,s.useState)(!1),{formatMessage:Be}=(0,N.A)(),Te={pagination:{rowsPerPage:(0,R.jsx)(q.A,{id:"AddrowsPerPage"}),previous:(0,R.jsx)(q.A,{id:"previous"}),next:(0,R.jsx)(q.A,{id:"next"}),page:(0,R.jsx)(q.A,{id:"page"})}};return(0,R.jsx)("div",{className:"w-100 ".concat("iransans"),children:(0,R.jsxs)("div",{className:"m-auto mt-5 m-5",style:{height:"100%",width:"99%"},children:[(0,R.jsx)("button",{type:"submit",className:"btn btn-info mb-1 p-1",style:{width:"100px"},onClick:()=>{M(!0)},children:(0,R.jsx)(q.A,{id:"Add"})}),(0,R.jsxs)("div",{dir:"en"===localStorage.getItem("language")?"ltr":"rtl",className:"bg-light d-flex justify-content-lg-betweend-flex flex-column flex-lg-row justify-content-lg-between align-items-start align-items-lg-center",style:{borderTop:"5px solid #4a5cf2"},children:[(0,R.jsx)("h2",{className:"m-2 fw-bold mb-4",children:(0,R.jsx)(q.A,{id:"Purchase Return"})}),(0,R.jsx)("input",{className:"form-control m-2 mb-4",style:{width:"100%",maxWidth:"200px"},type:"search",placeholder:Be({id:"Search"}),"aria-label":"Search"})]}),(0,R.jsx)(a.Ay,{localization:Te,columns:Pe,data:C,progressPending:pe,striped:!0,responsive:!0,highlightOnHover:!0,pagination:!0,paginationServer:!0,paginationTotalRows:xe,onChangePage:e=>{je(e)},onChangeRowsPerPage:async(e,t)=>{fe(e),je(t)},customStyles:{headCells:{style:{fontWeight:"bold"}}}}),(0,R.jsx)(B,{options1:f,setOptions1:S,customer:b,setcustomer:v,settings:ue,setsettings:me,records:C,setRecords:D,addAccountModal:W,setAddAccountModal:k,moneys:Me,AddSellModal:P,close:()=>M(!1),setAddBalanceModal:Y}),(0,R.jsx)(T,{PaidAmount:_e,setPaidAmount:Ie,TotalAmount:ve,setTotalAmount:we,returnbill:ze,setreturnbill:Ce,SoldRecords:ae,setSoldRecords:le,bill:oe,setbill:re,money:de,setmoney:ce,Exesting:Ne,setExesting:Re,records:C,setRecords:D,settings:ue,setsettings:me,AddSellModal:H,close:e=>Q(!1),moneys:Me,options1:f,setOptions1:S,customers:b,Customer:K,setCustomer:V,shopingcart:J,setshopingcart:U})]})})}}}]);
//# sourceMappingURL=2251.eb96bd18.chunk.js.map