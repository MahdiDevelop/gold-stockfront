"use strict";(self.webpackChunkdentest=self.webpackChunkdentest||[]).push([[845],{4293:(e,t,n)=>{n.d(t,{A:()=>i});var s=n(65043),a=(n(5813),n(97739)),o=(n(34348),n(70579));function i(e){let{handle_date:t,settings:n,default_value:i,lebal:r,onKeyDown:l}=e;const[c,d]=(0,s.useState)();return(0,o.jsxs)("div",{className:"col-3 m-2 mt-3",children:[(0,o.jsx)("label",{htmlFor:"",className:"p-0 m-0",children:r}),(0,o.jsx)(a.InputDatePicker,{onKeyDown:l,value:c,onChange:e=>{if(d(e),null!=e){const n={year:e._a[0],month:e._a[1]+1,day:e._a[2]};t(n)}},inputPlaceholder:"Persian"===n[0].date?"تاریخ را وارد کنید":"Enter the date",locale:"Persian"===n[0].date?"fa":"en",colorPrimary:"#0fbcf9",maximumDate:{year:9999,month:12,day:31},minimumDate:{year:1,month:1,day:1}})]})}},23135:(e,t,n)=>{n.r(t),n.d(t,{default:()=>$});var s=n(79722),a=n(65043),o=n(58786),i=n(85875),r=n(89379),l=n(90096),c=n(55191),d=n.n(c),u=n(10506),m=n.n(u),h=n(344),p=n(90551),x=n(97),g=n(53226),A=n(76583),f=n(83003),j=n(7353),y=n(94496),b=n(17392),S=n(74605),w=n(17843),v=n(5146),_=n(51787),I=n(11906),C=n(79650),k=n(61596),D=n(71806),z=n(84882),P=n(28076),W=n(10039),N=n(73460),M=n(40614),O=n(71360),B=n(9855),q=n(89577),T=n(70579);function E(e){let{settings:t,setsettings:n,AddItemModal:o,close:c,options1:u,records:E,setRecords:R,belance:H,moneys:G,setAddBalanceModal:F}=e;const Y=(0,A.N)(),{sidebars:Q}=(0,f.d4)(e=>e.sidebars),{formatMessage:V}=(0,x.A)(),[K,L]=(0,a.useState)(d()()),[$,U]=(0,a.useState)(),[X,J]=(0,a.useState)(),[Z,ee]=(0,a.useState)(d()()),[te,ne]=(0,a.useState)(!1),[se,ae]=(0,a.useState)(0),[oe,ie]=(0,a.useState)({id:0,belance:0}),[re,le]=(0,a.useState)([]),[ce,de]=(0,a.useState)({stocks_id:"",qty:null,weight:null,dateInsert:(new Date).toISOString(),rate:null,user_id:localStorage.getItem("userTokenid"),purchase_price:null,description:"",sell_price:null,expiry_date:(new Date).toISOString(),accounts_id:"",money:"",stock:{name:""},e_id:1}),[ue,me]=(0,a.useState)([]),[he,pe]=(0,a.useState)(0),xe=e=>{if(!ze&&0!=oe.belance)return void Y({position:"top-end",icon:"error",title:"You don't have enough belance!",showConfirmButton:!1,timer:1e3});if(!ve||!$||ue.length<=0)return void Y({position:"top-end",icon:"error",title:"You must fill the item input!",showConfirmButton:!1,timer:1e3});let n=[];ue.forEach(e=>{n.push({stocks_id:e.stocks_id,qty:e.qty,weight:e.weight,dateInsert:e.dateInsert,rate:e.rate,user_id:e.user_id,purchase_price:e.purchase_price,description:e.description,sell_price:0,expiry_date:e.expiry_date,accounts_id:e.accounts_id})});let a={arr:n},o=ve,r=$,l=ke,c=he,u=K;_e(null),me([]),L(d()()),U(null),ie({id:0,belance:0}),pe(0),De(0),ae(0),s.A.post(i.A.getAddress()+"/api/purchase",a,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))},params:{Exesting:ze?"ok":"no",money:o.id||0,accounts_id:r&&0!==r.id?r.id:"no",PaidAmount:l||0,TotalAmount:c,CustomerName:r.name,DateInsert:u}}).then(n=>{let s=n.data.bill;e&&(e=>{var n;const s=new Date(K);let a="".concat(s.getFullYear(),"-").concat(String(s.getMonth()+1).padStart(2,"0"),"-").concat(String(s.getDate()).padStart(2,"0"));const o=s.getHours(),r=s.getMinutes(),l=o%12||12,c=r<10?"0"+r:r;let u=o>=12?"pm":"am";"Persian"===t[0].date?(d().locale("fa"),a=d()(K).format("jYYYY/jMM/jDD")):d().locale("en"),a="".concat(a," ").concat(l,":").concat(c," ").concat(u);const m=null===(n=t[0])||void 0===n?void 0:n.company_pic;let h="";if(m){const e=m.split("/").pop();h=i.A.getAddress()+"/api/getImage/"+e}const p='\n    <html>\n        <head>\n            <title>Invoice</title>\n            <style>\n                body {\n                    font-family: Helvetica, sans-serif;\n                    font-size: 12px;\n                }\n\n                .invoice-container {\n                    width: 210mm;\n                    height: auto;\n                    padding: 10mm;\n                    box-sizing: border-box;\n                    background: #fff;\n                }\n\n                .header {\n                    text-align: center;\n                    margin-bottom: 20px;\n                }\n\n                .invoice-details {\n                    margin-bottom: 15px;\n                }\n\n                table {\n                    width: 100%;\n                    border-collapse: collapse;\n                    border: 1px solid #000;\n                }\n\n                th,\n                td {\n                    border: 1px solid #000;\n                    padding: 5px;\n                    text-align: left;\n                }\n\n                th {\n                    background-color: rgb(11, 105, 255);\n                    color: #fff;\n                    font-size: 12px;\n                }\n\n                td {\n                    font-size: 12px;\n                    color: #000;\n                }\n\n                .amount-details {\n                    text-align: right;\n                    margin-bottom: 20px;\n                }\n\n                .footer {\n                    text-align: center;\n                }\n\n                .logo {\n                    position: absolute;\n                    top: 10px;\n                    right: 10px;\n                    width: 30mm;\n                }\n\n                .even-row {\n                    background-color: #f5f5f5;\n                }\n\n                .odd-row {\n                    background-color: #fff;\n                }\n            </style>\n        </head>\n\n        <body>\n            <div class="invoice-container">\n                <div class="header">\n                    <h1 style="font-size: 26px; font-weight: bold; color: rgb(11,105,255); margin: 0;">Invoice</h1>\n                    <h2 style="font-size: 14px; margin: 5px 0; color: #000;">'.concat(t[0].company_name,'</h2>\n                    </div>\n                    \n                    <div class="invoice-details">\n                    <p style="font-size: 12px; margin: 0;">Customer Name: ').concat($?(x=$.name,x.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")):"N/A",'</p>\n                    <p style="font-size: 14px; color: rgb(11,105,255); margin: 0;">Invoice Number: ').concat(e,'</p>\n                    <p style="font-size: 12px; margin: 0;">Date: ').concat(a,'</p>\n                </div>\n\n                <hr style="border: 0; border-top: 1px solid #000; margin-bottom: 15px;">\n\n                <div style="margin-bottom: 20px;">\n                    <table style="width: 100%; border-collapse: collapse;" border="1" cellspacing="0" cellpadding="5">\n                        <thead style="background-color: rgb(11,105,255); font-size: 12px;">\n                            <tr>\n                                <th>No</th>\n                                <th>Name</th>\n                                <th>Quantity</th>\n                                <th>Price</th>\n                                <th>Total</th>\n                            </tr>\n                        </thead>\n                        <tbody style="font-size: 12px; color: #000;">\n                            ').concat(ue.map((e,t)=>'\n                                    <tr class="'.concat(t%2==0?"odd-row":"even-row",'">\n                                        <td>').concat(t+1,"</td>\n                                        <td>").concat(e.stock.name,"</td>\n                                        <td>").concat(e.qty,"</td>\n                                        <td>").concat(e.purchase_price," ").concat(ve?ve.name:"N/A","</td>\n                                        <td>").concat(e.purchase_price*e.qty," ").concat(ve?ve.name:"N/A","</td>\n                                    </tr>\n                                ")).join(""),'\n                        </tbody>\n                    </table>\n                </div>\n\n                <div class="amount-details">\n                    <p style="margin: 0;">Total Amount: ').concat(he," ").concat(ve?ve.name:"N/A",'</p>\n                    <p style="margin: 0;">Paid Amount: ').concat(ke||"0.00"," ").concat(ve?ve.name:"N/A",'</p>\n                    <p style="margin: 0;">Balance: ').concat(oe.belance," ").concat(ve?ve.name:"N/A",'</p>\n                </div>\n\n                <hr style="border: 0; border-top: 1px solid #000; margin-bottom: 15px;">\n\n                <div class="footer">\n                    <p style="margin: 0;">Address: ').concat(t[0].address,'</p>\n                    <p style="margin: 0;">Phone: ').concat(t[0].phone,'</p>\n                    <p style="margin: 0;">Email: ').concat(t[0].email,"</p>\n                </div>\n                 ").concat(h?'<img class="logo"  src="'.concat(h,'" alt="Company Logo"/>'):"","\n            </div>\n        </body>\n    </html>\n");var x;const g=window.open("","_blank");g?(g.document.open(),g.document.write(p),g.document.close(),g.onload=()=>{g.focus(),g.print(),g.close()}):alert("Please allow pop-ups for this website to print the invoice.")})(s.id),s.money=o,ze&&(s.accounts={account:r});let a={purchase:ue,bill:n.data.bill,money:o};R([a,...E]),Y({position:"top-end",icon:"success",title:(0,T.jsx)(g.A,{id:"Your record has been added!"}),showConfirmButton:!1,timer:1e3})}).catch(e=>{Y({position:"top-end",icon:"error",title:(0,T.jsx)(g.A,{id:"You must enter the customer name!"}),showConfirmButton:!1,timer:1e3})})},ge=e=>{de((0,r.A)((0,r.A)({},ce),{},{[e.target.name]:e.target.value}))},[Ae,fe]=(0,a.useState)([]),je=async e=>{},[ye,be]=(0,a.useState)(""),[Se,we]=(0,a.useState)(""),[ve,_e]=(0,a.useState)({name:""}),Ie=(0,a.useRef)(null),Ce=e=>{"Enter"===e.key&&(e.preventDefault(),Ie.current&&o&&Ie.current.click())},[ke,De]=(0,a.useState)(0);(0,a.useEffect)(()=>{ie(ke?e=>(0,r.A)((0,r.A)({},e),{},{belance:ke-he||0}):e=>(0,r.A)((0,r.A)({},e),{},{belance:-he}))},[ke,he,ue]);const[ze,Pe]=(0,a.useState)();return(0,a.useEffect)(()=>{if(ye){if(!ye||(null==ye?void 0:ye.length)<3)return void fe([]);ze&&(async()=>{try{const e=(await s.A.get("".concat(i.A.getAddress(),"/api/customers"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))},params:{query:ye,do:"ok"}})).data;fe(e)}catch(e){}})()}},[ye]),(0,T.jsxs)(j.A,{dir:"en"===localStorage.getItem("language")?"ltr":"rtl",sx:{width:"100%",maxWidth:1200,overflowX:"auto",overflowY:"auto",height:"75vh",bgcolor:"#f8f9fa",p:2,borderRadius:2,mx:"auto"},className:"popup transition ".concat(te&&"sellpurchase"," ").concat(o?"show":""),children:[(0,T.jsxs)(j.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,mb:2,children:[(0,T.jsx)(y.A,{variant:"h6",align:"center",sx:{bgcolor:"info.main",color:"#fff",p:1,borderRadius:1,flexGrow:1,fontSize:"1.1rem"},children:(0,T.jsx)(g.A,{id:"Add Purchase"})}),(0,T.jsx)(b.A,{onClick:c,"aria-label":"Close",sx:{ml:2},children:(0,T.jsx)(M.A,{size:24})})]}),(0,T.jsxs)(j.A,{boxShadow:2,p:2,borderRadius:2,mb:3,children:[(0,T.jsx)(y.A,{variant:"subtitle1",fontWeight:"bold",mb:2,children:(0,T.jsx)(g.A,{id:"Customer Info"})}),(0,T.jsxs)(j.A,{display:"flex",flexDirection:{xs:"column",md:"row"},gap:3,alignItems:"center",flexWrap:"wrap",children:[(0,T.jsx)(S.A,{control:(0,T.jsx)(w.A,{checked:ze,onChange:e=>Pe(e.target.checked)}),label:(0,T.jsx)(g.A,{id:"Exesting"}),sx:{minWidth:120}}),(0,T.jsxs)(j.A,{sx:{flexGrow:1,minWidth:200},children:[(0,T.jsx)(y.A,{component:"label",fontWeight:"bold",fontSize:"0.9rem",mb:1,display:"block",children:(0,T.jsx)(g.A,{id:"Customer Name"})}),(0,T.jsx)(h.A,{name:(0,T.jsx)(g.A,{id:"Add Customer"}),setAddAccountModal:e=>{let t={name:e,user_id:localStorage.getItem("userTokenid")};s.A.post(i.A.getAddress()+"/api/customers",t,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))}}).then(e=>{U(e.data.customer),fe([e.data.customer,...Ae]),Y({position:"top-end",icon:"success",title:"Customer has been created!",showConfirmButton:!1,timer:1e3})}).catch(e=>{Y({position:"top-end",icon:"error",title:"Sosmething went wrong!",showConfirmButton:!1,timer:1e3})})},type:ze,searchQuery:ye,handleInputChange:e=>{be(e),(async e=>{ze||e&&(de((0,r.A)((0,r.A)({},ce),{},{temp_customer:e})),U({id:null,name:e}))})(e)},setSelectedOption:U,selectedOption:$,options:Ae,Onsearch:e=>{e&&de((0,r.A)((0,r.A)({},ce),{},{accounts_id:e.id}))},compactMode:!0})]}),(0,T.jsxs)(j.A,{sx:{flexGrow:1,minWidth:180},children:[(0,T.jsx)(y.A,{component:"label",fontWeight:"bold",fontSize:"0.9rem",mb:1,display:"block",children:(0,T.jsx)(g.A,{id:"Currency"})}),(0,T.jsx)(p.A,{notCurrency:!1,isEditable:te,setSelectedOption:_e,selectedOption:ve,options:G,Onsearch:e=>{e&&de((0,r.A)((0,r.A)({},ce),{},{money:e.id}))},compactMode:!0})]}),(0,T.jsx)(j.A,{sx:{minWidth:180},children:(0,T.jsx)(l.A,{default_value:Z,handle_date:e=>{if(e){const{year:t,month:n,day:s}=e,a=(m().toGregorian(t,n,s),new Date);String(a.getHours()).padStart(2,"0"),String(a.getMinutes()).padStart(2,"0");const o=new Date,i=new Date(e.year,e.month-1,e.day,o.getHours(),o.getMinutes()).toISOString();de((0,r.A)((0,r.A)({},ce),{},{dateInsert:i}))}},lebal:(0,T.jsx)(g.A,{id:"Date"}),setSelectedDay:L,selectedDay:K,compactMode:!0})})]})]}),(0,T.jsxs)(j.A,{display:"flex",flexDirection:{xs:"column",md:"row"},gap:2,alignItems:"flex-end",flexWrap:"wrap",sx:{p:2,backgroundColor:"background.paper",borderRadius:2,boxShadow:1},children:[(0,T.jsxs)(j.A,{sx:{minWidth:240,flexGrow:1},children:[(0,T.jsx)(y.A,{variant:"subtitle2",fontWeight:"bold",gutterBottom:!0,children:(0,T.jsx)(g.A,{id:"Item Name"})}),(0,T.jsx)(p.A,{searchQuery:Se,setSearchQuery:we,handleInputChange:e=>{we(e),je()},handleSearch:je,setSelectedOption:e=>{J(e),e&&de((0,r.A)((0,r.A)({},ce),{},{stocks_id:e.id,stock:e}))},selectedOption:X,options:u,compactMode:!0,sx:{"& .MuiOutlinedInput-root":{height:40}}})]}),(0,T.jsx)(j.A,{sx:{width:120},children:(0,T.jsx)(q.HG,{onKeyDown:Ce,onValueChange:e=>{ge({target:{name:"qty",value:e.value}})},value:ce.qty,customInput:v.A,label:(0,T.jsx)(g.A,{id:"Quantity"}),size:"small",fullWidth:!0,thousandSeparator:!0,allowNegative:!1,decimalScale:0,InputProps:{sx:{height:40}}})}),"gold"===Q[0].type&&(0,T.jsx)(j.A,{sx:{width:160},children:(0,T.jsx)(q.HG,{value:ce.weight,thousandSeparator:",",decimalSeparator:".",decimalScale:3,name:"weight",onValueChange:e=>{ge({target:{name:"weight",value:e.value}})},customInput:v.A,label:(0,T.jsx)(g.A,{id:"Weight"}),size:"small",fullWidth:!0,allowNegative:!1,InputProps:{startAdornment:(0,T.jsx)(_.A,{position:"start",sx:{color:"text.secondary"},children:"Gram"}),sx:{height:40}}})}),(0,T.jsx)(j.A,{sx:{width:140},children:(0,T.jsx)(q.HG,{onKeyDown:Ce,onValueChange:e=>{ge({target:{name:"purchase_price",value:e.value}})},value:ce.purchase_price,customInput:v.A,label:(0,T.jsx)(g.A,{id:"Purchase Price"}),size:"small",fullWidth:!0,thousandSeparator:!0,decimalScale:2,allowNegative:!1,InputProps:{startAdornment:(0,T.jsx)(_.A,{position:"start",sx:{color:"text.secondary"},children:"$"}),sx:{height:40}}})}),(0,T.jsx)(j.A,{sx:{width:160},children:(0,T.jsx)(q.HG,{value:ce.qty*ce.purchase_price*(ce.weight||1),customInput:v.A,label:(0,T.jsx)(g.A,{id:"Total Amount"}),size:"small",fullWidth:!0,thousandSeparator:!0,decimalScale:2,InputProps:{readOnly:!0,startAdornment:(0,T.jsx)(_.A,{position:"start",sx:{color:"text.secondary"},children:"$"}),sx:{height:40,backgroundColor:"action.selected"}}})}),(0,T.jsx)(j.A,{sx:{width:140},children:(0,T.jsx)(q.HG,{value:X&&X.qty?parseInt(ce.qty||0)+parseInt(X.qty):"",customInput:v.A,label:(0,T.jsx)(g.A,{id:"Exest QTY"}),size:"small",fullWidth:!0,thousandSeparator:!0,decimalScale:0,InputProps:{readOnly:!0,sx:{height:40,backgroundColor:"action.selected"}}})}),(0,T.jsx)(j.A,{sx:{flexGrow:1,minWidth:240},children:(0,T.jsx)(v.A,{name:"description",multiline:!0,minRows:2,value:ce.description,onChange:ge,label:(0,T.jsx)(g.A,{id:"Description"}),size:"small",fullWidth:!0,InputProps:{sx:{alignItems:"flex-start",height:"auto"}}})}),(0,T.jsx)(I.A,{onClick:()=>(()=>{const e=ce.weight,t=ce.qty?parseInt(ce.qty):0,n=ce.purchase_price?parseFloat(ce.purchase_price):0;if(!(t&&n&&X&&e))return void Y({position:"top-end",icon:"error",title:(0,T.jsx)(g.A,{id:"Please select an item and fill the quantity and price!"}),showConfirmButton:!1,timer:1e3});if(t<=0||n<=0)return void Y({position:"top-end",icon:"error",title:(0,T.jsx)(g.A,{id:"Quantity and price must be positive values!"}),showConfirmButton:!1,timer:1e3});const s=(0,r.A)((0,r.A)({},ce),{},{item:(0,r.A)({},X)});s.item.qty=X.qty?t+parseInt(X.qty):t,me(e=>[...e,s]),pe(s=>s+t*n*e),De(s=>s+t*n*e),de({stocks_id:"",qty:"",weight:null,dateInsert:(new Date).toISOString(),rate:null,user_id:localStorage.getItem("userTokenid"),purchase_price:"",description:"",sell_price:null,expiry_date:(new Date).toISOString(),accounts_id:"",money:"",stock:{name:""},e_id:ce.e_id+1}),J(null)})(),variant:"contained",color:"primary",size:"medium",startIcon:(0,T.jsx)(O.A,{size:18}),sx:{height:40,minWidth:120,fontWeight:"bold",textTransform:"none",boxShadow:"none","&:hover":{boxShadow:"none"}},children:(0,T.jsx)(g.A,{id:"Add"})})]}),(0,T.jsxs)(j.A,{display:"flex",flexDirection:{xs:"column",md:"row"},gap:3,children:[(0,T.jsxs)(j.A,{flex:2,pr:{md:2},children:[(0,T.jsx)(y.A,{variant:"subtitle1",sx:{bgcolor:"info.main",color:"#fff",p:1,borderRadius:1,fontSize:"1rem",mb:1},align:"center",children:(0,T.jsx)(g.A,{id:"Purchase stocks"})}),(0,T.jsx)(C.A,{component:k.A,sx:{maxHeight:320},children:(0,T.jsxs)(D.A,{size:"small",stickyHeader:!0,children:[(0,T.jsx)(z.A,{children:(0,T.jsxs)(P.A,{children:[(0,T.jsx)(W.A,{sx:{width:"5%"},children:(0,T.jsx)(g.A,{id:"ID"})}),(0,T.jsx)(W.A,{sx:{width:"20%"},children:(0,T.jsx)(g.A,{id:"Name"})}),(0,T.jsx)(W.A,{sx:{width:"10%"},children:(0,T.jsx)(g.A,{id:"Quantity"})}),"gold"===Q[0].type&&(0,T.jsx)(W.A,{sx:{width:"10%"},children:(0,T.jsx)(g.A,{id:"weight"})}),(0,T.jsx)(W.A,{sx:{width:"10%"},children:(0,T.jsx)(g.A,{id:"Price"})}),(0,T.jsx)(W.A,{sx:{width:"10%"},children:(0,T.jsx)(g.A,{id:"Total"})}),(0,T.jsx)(W.A,{sx:{width:"30%"},children:(0,T.jsx)(g.A,{id:"Description"})}),(0,T.jsx)(W.A,{sx:{width:"5%"},children:(0,T.jsx)(g.A,{id:"Delete"})})]})}),(0,T.jsx)(N.A,{children:ue&&ue.map((e,t)=>(0,T.jsxs)(P.A,{children:[(0,T.jsx)(W.A,{children:e.e_id}),(0,T.jsx)(W.A,{children:e.stock.name}),(0,T.jsx)(W.A,{children:e.qty}),"gold"===Q[0].type&&(0,T.jsx)(W.A,{children:e.weight}),(0,T.jsx)(W.A,{children:e.purchase_price}),(0,T.jsx)(W.A,{children:e.purchase_price*e.qty}),(0,T.jsx)(W.A,{children:e.description}),(0,T.jsx)(W.A,{children:(0,T.jsx)(b.A,{onClick:()=>{return t=e,ie((0,r.A)((0,r.A)({},oe),{},{belance:oe.belance-t.qty*t.sell_price})),pe(e=>e-t.qty*t.purchase_price*t.weight),De(e=>e-t.qty*t.purchase_price*t.weight),void me(e=>e.filter(e=>e.e_id!==t.e_id));var t},children:(0,T.jsx)(B.A,{size:18})})})]},t))})]})})]}),(0,T.jsxs)(j.A,{flex:1,pl:{md:2},marginTop:2,children:[(0,T.jsx)(v.A,{value:he,label:(0,T.jsx)(g.A,{id:"Total Amount"}),InputProps:{readOnly:!0},size:"small",fullWidth:!0,sx:{mb:1}}),(0,T.jsx)(v.A,{value:ke,onChange:e=>{De(e.target.value)},InputProps:{readOnly:!ze},label:(0,T.jsx)(g.A,{id:"Paid Amount"}),size:"small",fullWidth:!0,sx:{mb:1}}),(0,T.jsx)(v.A,{value:oe.belance,InputProps:{readOnly:!0},label:(0,T.jsx)(g.A,{id:"Remain Balance"}),size:"small",fullWidth:!0,sx:{mb:2}}),(0,T.jsxs)(j.A,{display:"flex",justifyContent:"center",gap:2,children:[(0,T.jsx)(I.A,{variant:"outlined",color:"error",size:"medium",onClick:c,children:(0,T.jsx)(g.A,{id:"Cancel"})}),(0,T.jsx)(I.A,{variant:"contained",color:"success",size:"medium",onClick:()=>xe(!1),children:(0,T.jsx)(g.A,{id:"Submit"})}),(0,T.jsx)(I.A,{variant:"contained",color:"success",size:"medium",onClick:()=>xe(!0),children:(0,T.jsx)(g.A,{id:"Print And Save"})})]})]})]})]})}var R=n(30064),H=n.n(R),G=n(13869),F=n(38183),Y=n(30232),Q=n(14635),V=(n(36622),n(71933),n(26680),n(36860),n(34565),n(95492),n(47295),n(62299),n(10068),n(91814));n(29022);function K(e){let{records:t,setRecords:n,AddItemModal:o,close:c,money:u,setmoney:E,moneys:R,Customer:H,setCustomer:G,shopingcart:F,setshopingcart:Y,Exesting:Q,setExesting:K,options1:L,setOptions1:$}=e;const{sidebars:U}=(0,f.d4)(e=>e.sidebars),X=(0,A.N)(),{formatMessage:J}=(0,x.A)(),[Z,ee]=(0,a.useState)(d()()),[te,ne]=(0,a.useState)(d()()),[se,ae]=(0,a.useState)({name:""}),[oe,ie]=(0,a.useState)(),re=(0,f.wA)(),{customers:le,errorc:ce,statusc:de}=(0,f.d4)(e=>e.customers),{settings:ue,errors:me,statuss:he}=(0,f.d4)(e=>e.settings);(0,a.useEffect)(()=>{he||ue||re((0,V.mt)())},[re,de]);const[pe,xe]=(0,a.useState)(d()()),[ge,Ae]=(0,a.useState)(!1),[fe,je]=(0,a.useState)({id:0,belance:0}),[ye,be]=(0,a.useState)([]),[Se,we]=(0,a.useState)({stocks_id:"",qty:0,weight:0,dateInsert:(new Date).toISOString(),rate:0,user_id:localStorage.getItem("userTokenid"),purchase_price:0,description:"Description",sell_price:0,expiry_date:(new Date).toISOString(),accounts_id:"",money:"",stock:{name:""},e_id:1}),[ve,_e]=(0,a.useState)(0),[Ie,Ce]=(0,a.useState)(!1);(0,a.useEffect)(()=>{H&&(ae({name:H.accounts?H.accounts.account.name:H.temp_customer}),Te(H.money),ee(d()(H.Inserdate)),_e(H.total),Ge(H.PaidAmount))},[H]);const ke=()=>{let e=[];F.forEach(t=>{e.push({stocks_id:t.stocks_id,qty:t.qty,weight:t.weight,dateInsert:t.dateInsert,rate:t.rate,user_id:t.user_id,purchase_price:t.purchase_price,description:t.description,sell_price:0,bill_id:t.bill_id||null,expiry_date:t.expiry_date,accounts_id:t.accounts_id})});let t={arr:e,_method:"put"};s.A.post(i.A.getAddress()+"/api/purchase/"+H.id,t,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))},params:{Bill_id:H.id,prevMoney:H.money_id,primaryTotalAmount:H.total,primaryPaidAmount:H.PaidAmount,Accounts_id:H.accounts_id||"0",Exesting:Q?"ok":"no",money:qe.id||0,accounts_id:se.id,PaidAmount:He||0,TotalAmount:ve,CustomerName:se.name,DateInsert:F[0].dateInsert}}).then(e=>{let t=e.data.bill;t.money=qe,t.accounts={account:se};let s={purchase:F,bill:e.data.bill,accounts:e.data.belance};n(t=>t.map(t=>t.bill.id===e.data.bill.id?s:t)),X({position:"top-end",icon:"success",title:(0,T.jsx)(g.A,{id:"Your record has been updated!"}),showConfirmButton:!1,timer:1e3})}).catch(e=>{X({position:"top-end",icon:"error",title:(0,T.jsx)(g.A,{id:"Not working ,please try again!"}),showConfirmButton:!1,timer:1e3})})},De=e=>{we((0,r.A)((0,r.A)({},Se),{},{[e.target.name]:e.target.value}))},[ze,Pe]=(0,a.useState)([]),We=async e=>{},[Ne,Me]=(0,a.useState)(""),[Oe,Be]=(0,a.useState)(""),[qe,Te]=(0,a.useState)({name:""}),Ee=(0,a.useRef)(null),Re=e=>{"Enter"===e.key&&(e.preventDefault(),Ee.current&&o&&Ee.current.click())},[He,Ge]=(0,a.useState)();(0,a.useEffect)(()=>{je(He?e=>(0,r.A)((0,r.A)({},e),{},{belance:ve-He||0}):e=>(0,r.A)((0,r.A)({},e),{},{belance:ve}))},[He,ve,F]);return(0,a.useEffect)(()=>{if(Ne){if(!Ne||(null==Ne?void 0:Ne.length)<3)return void Pe([]);Q&&(async()=>{try{const e=(await s.A.get("".concat(i.A.getAddress(),"/api/customers"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))},params:{query:Ne,do:"ok"}})).data;Pe(e)}catch(e){}})()}},[Ne]),(0,T.jsxs)(j.A,{dir:"en"===localStorage.getItem("language")?"ltr":"rtl",sx:{width:"100%",maxWidth:1200,overflowX:"auto",overflowY:"auto",height:"75vh",bgcolor:"#f8f9fa",p:2,borderRadius:2,mx:"auto"},className:"popup transition ".concat(ge&&"sellpurchase"," ").concat(o?"show":""),children:[(0,T.jsxs)(j.A,{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,mb:2,children:[(0,T.jsx)(y.A,{variant:"h6",align:"center",sx:{bgcolor:"info.main",color:"#fff",p:1,borderRadius:1,flexGrow:1,fontSize:"1.1rem"},children:(0,T.jsx)(g.A,{id:"Edit Purchase"})}),(0,T.jsx)(b.A,{onClick:c,"aria-label":"Close",sx:{ml:2},children:(0,T.jsx)(M.A,{size:24})})]}),(0,T.jsxs)(j.A,{boxShadow:2,p:2,borderRadius:2,mb:3,children:[(0,T.jsx)(y.A,{variant:"subtitle1",fontWeight:"bold",mb:2,children:(0,T.jsx)(g.A,{id:"Customer Info"})}),(0,T.jsxs)(j.A,{display:"flex",flexDirection:{xs:"column",md:"row"},gap:3,alignItems:"center",flexWrap:"wrap",children:[(0,T.jsx)(S.A,{control:(0,T.jsx)(w.A,{checked:Q,onChange:e=>K(e.target.checked)}),label:(0,T.jsx)(g.A,{id:"Exesting"}),sx:{minWidth:120}}),(0,T.jsxs)(j.A,{sx:{flexGrow:1,minWidth:200},children:[(0,T.jsx)(y.A,{component:"label",fontWeight:"bold",fontSize:"0.9rem",mb:1,display:"block",children:(0,T.jsx)(g.A,{id:"Customer Name"})}),(0,T.jsx)(h.A,{name:(0,T.jsx)(g.A,{id:"Add Customer"}),setAddAccountModal:e=>{let t={name:e};s.A.post(i.A.getAddress()+"/api/customers",t,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))}}).then(e=>{ae(e.data.customer),X({position:"top-end",icon:"success",title:"Customer has been created!",showConfirmButton:!1,timer:1e3})}).catch(e=>{X({position:"top-end",icon:"error",title:"Sosmething went wrong!",showConfirmButton:!1,timer:1e3})})},type:Q,searchQuery:Ne,handleInputChange:e=>{Me(e),(async e=>{Q||e&&(we((0,r.A)((0,r.A)({},Se),{},{temp_customer:e})),ae({id:1,name:e}))})(e)},setSelectedOption:ae,selectedOption:se,options:ze,Onsearch:e=>{ae(e),e&&we((0,r.A)((0,r.A)({},Se),{},{accounts_id:e.id}))},compactMode:!0})]}),(0,T.jsxs)(j.A,{sx:{flexGrow:1,minWidth:180},children:[(0,T.jsx)(y.A,{component:"label",fontWeight:"bold",fontSize:"0.9rem",mb:1,display:"block",children:(0,T.jsx)(g.A,{id:"Currency"})}),(0,T.jsx)(h.A,{notCurrency:!1,isEditable:ge,setSelectedOption:Te,selectedOption:qe,options:R,Onsearch:e=>{e&&we((0,r.A)((0,r.A)({},Se),{},{money:e.id}))},compactMode:!0})]}),(0,T.jsx)(j.A,{sx:{minWidth:180},children:(0,T.jsx)(l.A,{default_value:pe,handle_date:e=>{if(e){const{year:t,month:n,day:s}=e,a=(m().toGregorian(t,n,s),new Date);String(a.getHours()).padStart(2,"0"),String(a.getMinutes()).padStart(2,"0");const o=new Date,i=new Date(e.year,e.month-1,e.day,o.getHours(),o.getMinutes()).toISOString();we((0,r.A)((0,r.A)({},Se),{},{dateInsert:i}))}},lebal:(0,T.jsx)(g.A,{id:"Date"}),setSelectedDay:ee,selectedDay:Z,compactMode:!0})})]})]}),(0,T.jsxs)(j.A,{display:"flex",flexDirection:{xs:"column",md:"row"},gap:2,alignItems:"flex-end",flexWrap:"wrap",sx:{p:2,backgroundColor:"background.paper",borderRadius:2,boxShadow:1},children:[(0,T.jsxs)(j.A,{sx:{minWidth:240,flexGrow:1},children:[(0,T.jsx)(y.A,{variant:"subtitle2",fontWeight:"bold",gutterBottom:!0,children:(0,T.jsx)(g.A,{id:"Item Name"})}),(0,T.jsx)(p.A,{searchQuery:Oe,setSearchQuery:Be,handleInputChange:e=>{Be(e),We()},handleSearch:We,setSelectedOption:e=>{ie(e),e&&we((0,r.A)((0,r.A)({},Se),{},{stocks_id:e.id,stock:e}))},selectedOption:oe,options:L,compactMode:!0,sx:{"& .MuiOutlinedInput-root":{height:40}}})]}),(0,T.jsx)(j.A,{sx:{width:120},children:(0,T.jsx)(q.HG,{onKeyDown:Re,onValueChange:e=>{De({target:{name:"qty",value:e.value}})},value:Se.qty,customInput:v.A,label:(0,T.jsx)(g.A,{id:"Quantity"}),size:"small",fullWidth:!0,thousandSeparator:!0,allowNegative:!1,decimalScale:0,InputProps:{sx:{height:40}}})}),"gold"===U[0].type&&(0,T.jsx)(j.A,{sx:{width:160},children:(0,T.jsx)(q.HG,{value:Se.weight,thousandSeparator:",",decimalSeparator:".",decimalScale:3,name:"weight",onValueChange:e=>{De({target:{name:"weight",value:e.value}})},customInput:v.A,label:(0,T.jsx)(g.A,{id:"Weight"}),size:"small",fullWidth:!0,allowNegative:!1,InputProps:{startAdornment:(0,T.jsx)(_.A,{position:"start",sx:{color:"text.secondary"},children:"Gram"}),sx:{height:40}}})}),(0,T.jsx)(j.A,{sx:{width:140},children:(0,T.jsx)(q.HG,{onKeyDown:Re,onValueChange:e=>{De({target:{name:"purchase_price",value:e.value}})},value:Se.purchase_price,customInput:v.A,label:(0,T.jsx)(g.A,{id:"Purchase Price"}),size:"small",fullWidth:!0,thousandSeparator:!0,decimalScale:2,allowNegative:!1,InputProps:{startAdornment:(0,T.jsx)(_.A,{position:"start",sx:{color:"text.secondary"},children:"$"}),sx:{height:40}}})}),(0,T.jsx)(j.A,{sx:{width:160},children:(0,T.jsx)(q.HG,{value:Se.qty*Se.purchase_price*(Se.weight||1),customInput:v.A,label:(0,T.jsx)(g.A,{id:"Total Amount"}),size:"small",fullWidth:!0,thousandSeparator:!0,decimalScale:2,InputProps:{readOnly:!0,startAdornment:(0,T.jsx)(_.A,{position:"start",sx:{color:"text.secondary"},children:"$"}),sx:{height:40,backgroundColor:"action.selected"}}})}),(0,T.jsx)(j.A,{sx:{width:140},children:(0,T.jsx)(q.HG,{value:oe&&oe.qty?parseInt(Se.qty||0)+parseInt(oe.qty):"",customInput:v.A,label:(0,T.jsx)(g.A,{id:"Exest QTY"}),size:"small",fullWidth:!0,thousandSeparator:!0,decimalScale:0,InputProps:{readOnly:!0,sx:{height:40,backgroundColor:"action.selected"}}})}),(0,T.jsx)(j.A,{sx:{flexGrow:1,minWidth:240},children:(0,T.jsx)(v.A,{name:"description",multiline:!0,minRows:2,value:Se.description,onChange:De,label:(0,T.jsx)(g.A,{id:"Description"}),size:"small",fullWidth:!0,InputProps:{sx:{alignItems:"flex-start",height:"auto"}}})}),(0,T.jsx)(I.A,{onClick:()=>(()=>{const e=Se.qty?parseInt(Se.qty):0,t=Se.weight,n=Se.purchase_price?parseFloat(Se.purchase_price):0;if(!e||!n||!oe||t)return void X({position:"top-end",icon:"error",title:(0,T.jsx)(g.A,{id:"Please select an item and fill the quantity and price!"}),showConfirmButton:!1,timer:1e3});if(e<=0||n<=0)return void X({position:"top-end",icon:"error",title:(0,T.jsx)(g.A,{id:"Quantity and price must be positive values!"}),showConfirmButton:!1,timer:1e3});const s=(0,r.A)((0,r.A)({},Se),{},{item:(0,r.A)({},oe)});s.item.qty=oe.qty?e+parseInt(oe.qty):e;let a=F.length>0?F[F.length-1].id+1:1;s.id=a,Y(e=>[...e,s]),_e(t=>t+e*n),Ge(t=>t+e*n),we({stocks_id:"",qty:"",weight:null,dateInsert:(new Date).toISOString(),rate:null,user_id:localStorage.getItem("userTokenid"),purchase_price:"",description:"",sell_price:null,expiry_date:(new Date).toISOString(),accounts_id:"",money:"",stock:{name:""},e_id:Se.e_id+1}),ie(null)})(),variant:"contained",color:"primary",size:"medium",startIcon:(0,T.jsx)(O.A,{size:18}),sx:{height:40,minWidth:120,fontWeight:"bold",textTransform:"none",boxShadow:"none","&:hover":{boxShadow:"none"}},children:(0,T.jsx)(g.A,{id:"Add"})})]}),(0,T.jsxs)(j.A,{display:"flex",flexDirection:{xs:"column",md:"row"},gap:3,children:[(0,T.jsxs)(j.A,{flex:2,pr:{md:2},children:[(0,T.jsx)(y.A,{variant:"subtitle1",sx:{bgcolor:"info.main",color:"#fff",p:1,borderRadius:1,fontSize:"1rem",mb:1},align:"center",children:(0,T.jsx)(g.A,{id:"Purchase stocks"})}),(0,T.jsx)(C.A,{component:k.A,sx:{maxHeight:320},children:(0,T.jsxs)(D.A,{size:"small",stickyHeader:!0,children:[(0,T.jsx)(z.A,{children:(0,T.jsxs)(P.A,{children:[(0,T.jsx)(W.A,{sx:{width:"5%"},children:(0,T.jsx)(g.A,{id:"ID"})}),(0,T.jsx)(W.A,{sx:{width:"20%"},children:(0,T.jsx)(g.A,{id:"Name"})}),(0,T.jsx)(W.A,{sx:{width:"10%"},children:(0,T.jsx)(g.A,{id:"Quantity"})}),"gold"===U[0].type&&(0,T.jsx)(W.A,{sx:{width:"10%"},children:(0,T.jsx)(g.A,{id:"weight"})}),(0,T.jsx)(W.A,{sx:{width:"10%"},children:(0,T.jsx)(g.A,{id:"Price"})}),(0,T.jsx)(W.A,{sx:{width:"10%"},children:(0,T.jsx)(g.A,{id:"Total"})}),(0,T.jsx)(W.A,{sx:{width:"30%"},children:(0,T.jsx)(g.A,{id:"Description"})}),(0,T.jsx)(W.A,{sx:{width:"5%"},children:(0,T.jsx)(g.A,{id:"Delete"})})]})}),(0,T.jsx)(N.A,{children:F&&F.map((e,t)=>(0,T.jsxs)(P.A,{children:[(0,T.jsx)(W.A,{children:e.e_id}),(0,T.jsx)(W.A,{children:e.stock.name}),(0,T.jsx)(W.A,{children:e.qty}),"gold"===U[0].type&&(0,T.jsx)(W.A,{children:e.weight}),(0,T.jsx)(W.A,{children:e.purchase_price}),(0,T.jsx)(W.A,{children:e.purchase_price*e.qty}),(0,T.jsx)(W.A,{children:e.description}),(0,T.jsx)(W.A,{children:(0,T.jsx)(b.A,{onClick:()=>{return t=e,_e(e=>e-t.qty*t.purchase_price*t.weight),Ge(e=>e-t.qty*t.purchase_price*t.weight),void Y(e=>e.filter(e=>e.id!==t.id));var t},children:(0,T.jsx)(B.A,{size:18})})})]},t))})]})})]}),(0,T.jsxs)(j.A,{flex:1,pl:{md:2},children:[(0,T.jsx)(v.A,{value:ve,label:(0,T.jsx)(g.A,{id:"Total Amount"}),InputProps:{readOnly:!0},size:"small",fullWidth:!0,sx:{mb:1}}),(0,T.jsx)(v.A,{value:He,onChange:e=>{Ge(e.target.value)},InputProps:{readOnly:!Q},label:(0,T.jsx)(g.A,{id:"Paid Amount"}),size:"small",fullWidth:!0,sx:{mb:1}}),(0,T.jsx)(v.A,{value:fe.belance,InputProps:{readOnly:!0},label:(0,T.jsx)(g.A,{id:"Remain Balance"}),size:"small",fullWidth:!0,sx:{mb:2}}),(0,T.jsxs)(j.A,{display:"flex",justifyContent:"center",gap:2,children:[(0,T.jsx)(I.A,{variant:"outlined",color:"error",size:"medium",onClick:c,children:(0,T.jsx)(g.A,{id:"Cancel"})}),(0,T.jsx)(I.A,{variant:"contained",color:"success",size:"medium",onClick:()=>ke(),children:(0,T.jsx)(g.A,{id:"Submit"})}),(0,T.jsx)(I.A,{variant:"contained",color:"success",size:"medium",onClick:()=>ke(),children:(0,T.jsx)(g.A,{id:"Print And Save"})})]})]})]})]})}n(23603),n(78425),n(85564);var L=n(61238);n(66885);function $(){(0,A.N)();const[e,t]=(0,a.useState)(),{users:n,statusu:r}=(0,f.d4)(e=>e.users),[c,u]=(0,a.useState)(),[h,p]=(0,a.useState)(),[j,y]=(0,a.useState)(),[b,S]=(0,a.useState)(),[w,v]=(0,a.useState)(),[_,I]=(0,a.useState)(window.innerWidth>768),{settings:C,errors:k,statuss:D}=((0,f.wA)(),(0,f.d4)(e=>e.settings)),[z,P]=(0,a.useState)([]),[W,N]=(0,a.useState)(!1),[M,O]=(0,a.useState)([]),[B,q]=(0,a.useState)(!1),[R,V]=(0,a.useState)([]),[$,U]=(0,a.useState)(),[X,J]=(0,a.useState)(!1),[Z,ee]=(0,a.useState)(!1),[te,ne]=(0,a.useState)([]),[se,ae]=(0,a.useState)([]),[oe,ie]=(0,a.useState)([]),[re,le]=(0,a.useState)(!1),ce=()=>{0===R.length&&s.A.get("".concat(i.A.getAddress(),"/api/item"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))},params:{query:"ok"}}).then(e=>{V(e.data)}).catch(e=>{}),0===ve.length&&s.A.get(i.A.getAddress()+"/api/money",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))},params:{delete:"False"}}).then(e=>{_e(e.data)}).catch(e=>{})},[de,ue]=(0,a.useState)(C),[me,he]=(0,a.useState)(0),[pe,xe]=(0,a.useState)(!1),[ge,Ae]=(0,a.useState)(1),[fe,je]=(0,a.useState)(10),[ye,be]=(0,a.useState)([]),[Se,we]=(0,a.useState)([]),[ve,_e]=(0,a.useState)([]);(0,a.useEffect)(()=>{(async(t,n)=>{xe(!0);try{const a=await s.A.get(i.A.getAddress()+"/api/purchase",{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))},params:{user_id:e.id,page:t,perPage:n,StartDate:b&&h,EndDate:w&&j,search:null!=c&&c.length?c:"false",delete:0}});O(a.data.data),he(a.data.total),xe(!1)}catch(e){xe(!1)}})(ge,fe)},[ge,fe,w,b,e,c]);const Ie=(0,x.A)(),Ce=[{name:(0,T.jsx)(g.A,{id:"Bill Number"}),selector:e=>e.bill.id,sortable:!0,style:{width:"1px",minWidth:"1px"}},{name:(0,T.jsx)(g.A,{id:"Name"}),selector:e=>e.bill.temp_customer?e.bill.temp_customer:e.bill.accounts.account.name,sortable:!0,style:{width:"1px",minWidth:"1px"}},{name:(0,T.jsx)("strong",{style:{minWidth:"200px",maxWidth:"240px",width:"240px"},children:(0,T.jsx)(g.A,{id:"Date Created"})}),selector:e=>De(e.bill.dateInsert)},{name:(0,T.jsx)(g.A,{id:"Currency"}),selector:e=>e.bill.money.name,sortable:!0},{name:(0,T.jsx)(g.A,{id:"Total Amount"}),selector:e=>e.bill.total,sortable:!0},{name:(0,T.jsx)(g.A,{id:"Paid Amount"}),selector:e=>e.bill.PaidAmount,sortable:!0},{name:(0,T.jsx)(g.A,{id:"Remain Amount"}),selector:e=>e.bill.Remain,sortable:!0},{name:(0,T.jsx)("strong",{style:{textAlign:"center",backgroundColor:"tranceparent",width:"100%"},children:(0,T.jsx)(g.A,{id:"Show"})}),selector:e=>(0,T.jsx)("button",{onClick:t=>{ce(),le(!!e.bill.accounts),ee(!0),ne(e.money),ae(e.bill),ie(e.purchase)},style:{border:"none",backgroundColor:"transparent",height:"100%"},children:(0,T.jsx)("img",{height:"15%",width:"15%",src:Q,style:{backgroundColor:"tranceparent"}})})},{name:(0,T.jsx)("strong",{style:{textAlign:"center",backgroundColor:"tranceparent",width:"100%"},children:(0,T.jsx)(g.A,{id:"Delete"})}),selector:e=>(0,T.jsx)("button",{onClick:()=>{(async e=>{const t=H().mixin({customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1}),n=await t.fire({title:Ie.formatMessage({id:"Are you sure?"}),text:Ie.formatMessage({id:"You won't be able to revert this!"}),icon:"warning",showCancelButton:!0,confirmButtonText:Ie.formatMessage({id:"Yes, delete it!"}),cancelButtonText:Ie.formatMessage({id:"No, cancel!"}),reverseButtons:!0});if(n.isConfirmed){const t={money:e.money.id,bill:e.bill.id,_method:"put"};try{await s.A.post("".concat(i.A.getAddress(),"/api/purchase/").concat(e.bill.id),t,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))},params:{type:"delete"}}),H().fire({position:"center",icon:"success",title:Ie.formatMessage({id:"record successfully deleted!"}),showConfirmButton:!1,timer:600}),O(t=>t.filter(t=>t.bill.id!==e.bill.id))}catch(e){H().fire({position:"center",icon:"error",title:Ie.formatMessage({id:"Something went wrong!"}),showConfirmButton:!1,timer:600})}}else n.dismiss===H().DismissReason.cancel&&H().fire({position:"center",icon:"error",text:Ie.formatMessage({id:"Your record is safe :)"}),showConfirmButton:!1,timer:600})})(e)},style:{border:"none",backgroundColor:"transparent",height:"100%"},children:(0,T.jsx)("img",{height:"20%",width:"20%",src:Y,style:{backgroundColor:"tranceparent"}})})}],ke=(0,a.useMemo)(()=>{let e;return e="pa"===localStorage.getItem("language")||"da"===localStorage.getItem("language")?[...Ce]:Ce,e},[_]),De=e=>{const t=new Date(e);let n="".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"),"-").concat(String(t.getDate()).padStart(2,"0"));const s=t.getHours(),a=t.getMinutes();let o=s>=12?"pm":"am";const i=s%12||12,r=a<10?"0"+a:a;return"Persian"===localStorage.getItem("date")?(d().locale("fa"),o=s>=12?"ب.ظ":"ق.ظ",n=d()(e).format("jYYYY-jMM-jDD")):d().locale("en"),"".concat(n," ").concat(i,":").concat(r," ").concat(o)},[ze,Pe]=(0,a.useState)([]),[We,Ne]=(0,a.useState)([]),{formatMessage:Me}=(0,x.A)(),Oe={pagination:{rowsPerPage:(0,T.jsx)(g.A,{id:"AddrowsPerPage"}),previous:(0,T.jsx)(g.A,{id:"previous"}),next:(0,T.jsx)(g.A,{id:"next"}),page:(0,T.jsx)(g.A,{id:"page"})}};return(0,T.jsx)("div",{className:"w-100 ".concat("iransans"),children:(0,T.jsxs)("div",{className:"m-auto mt-5 m-5",style:{height:"100%",width:"99%"},children:[(0,T.jsx)("button",{type:"submit",className:"btn btn-info mb-1 p-1",style:{width:"100px"},onClick:()=>{q(!0),ce()},children:(0,T.jsx)(g.A,{id:"Add"})}),(0,T.jsxs)("div",{dir:"en"===localStorage.getItem("language")?"ltr":"rtl",className:"bg-light d-flex flex-column flex-lg-row justify-content-lg-between align-items-start align-items-lg-center",style:{borderTop:"5px solid #4a5cf2"},children:[(0,T.jsx)("h2",{className:"m-2 fw-bold mb-4",children:(0,T.jsx)(g.A,{id:"Purchase"})}),(0,T.jsxs)("div",{className:"d-flex flex-column flex-lg-row align-items-start align-items-lg-center",children:[(0,T.jsx)("div",{className:"mb-1 mb-lg-0 me-lg-2 mt-1 ",children:(0,T.jsx)(l.A,{default_value:b,handle_date:e=>{if(e){const{year:t,month:n,day:s}=e,a=(m().toGregorian(t,n,s),new Date);String(a.getHours()).padStart(2,"0"),String(a.getMinutes()).padStart(2,"0");const o=new Date,i=new Date(e.year,e.month-1,e.day,o.getHours(),o.getMinutes()).toISOString();p(i)}},lebal:(0,T.jsx)(g.A,{id:"Start"}),setSelectedDay:S,selectedDay:b})}),(0,T.jsx)("div",{className:"mb-1 mt-1 mb-lg-0 me-lg-2",children:(0,T.jsx)(l.A,{default_value:w,handle_date:e=>{if(e){const{year:t,month:n,day:s}=e,a=(m().toGregorian(t,n,s),new Date);String(a.getHours()).padStart(2,"0"),String(a.getMinutes()).padStart(2,"0");const o=new Date,i=new Date(e.year,e.month-1,e.day,o.getHours(),o.getMinutes()).toISOString();y(i)}},lebal:(0,T.jsx)(g.A,{id:"End"}),setSelectedDay:v,selectedDay:w})}),(0,T.jsx)(L.A,{options:n,selectedOption:e,setSelectedOption:t})]}),(0,T.jsx)("input",{className:"form-control m-2 mb-2 mt-4",style:{width:"100%",maxWidth:"200px"},type:"search",onChange:e=>{u(e.target.value)},value:c,placeholder:Me({id:"Search"}),"aria-label":"Search"})]}),(0,T.jsx)(o.Ay,{localization:Oe,columns:ke,data:M,progressPending:pe,striped:!0,responsive:!0,highlightOnHover:!0,pagination:!0,paginationServer:!0,paginationTotalRows:me,onChangePage:e=>{Ae(e)},onChangeRowsPerPage:async(e,t)=>{je(e),Ae(t)},customStyles:{headCells:{style:{display:"flex",minWidth:"100px",maxWidth:"100px",width:"10px",margin:"0px",fontWeight:"bold"}},cells:{style:{minWidth:"100px",maxWidth:"150px",width:"150px"}}}}),(0,T.jsx)(E,{customers:Se,setsettings:ue,settings:de,belance:$,records:M,setRecords:O,options1:R,moneys:ve,AddItemModal:B,close:()=>q(!1),setAddAccountModal:N,setAddBalanceModal:J}),(0,T.jsx)(F.A,{accounts:$,setAccounts:U,close:()=>J(!1),addAccountModal:X,records:$,setRecords:U,money:ve,setAddcustomerModal:N}),(0,T.jsx)(G.A,{close:()=>N(!1),addAccountModal:W,records:ze,setRecords:Pe}),(0,T.jsx)(K,{Exesting:re,setExesting:le,records:M,setRecords:O,AddItemModal:Z,close:e=>ee(!1),money:te,setmoney:ne,moneys:ve,Customer:se,setCustomer:ae,shopingcart:oe,setshopingcart:ie,options1:R,setOptions1:V})]})})}},38183:(e,t,n)=>{n.d(t,{A:()=>f});var s=n(89379),a=n(65043),o=n(85875),i=n(79722),r=(n(71933),n(26680),n(344)),l=(n(4293),n(21443)),c=n(10506),d=n.n(c),u=n(90096),m=n(55191),h=n.n(m),p=n(83003),x=(n(10068),n(53226)),g=n(76583),A=n(70579);function f(e){let{setAccounts:t,close:n,addAccountModal:c,records:m,setRecords:f,setAddcustomerModal:j,accounts:y,money:b}=e;const S=(0,g.N)(),{customers:w,errorc:v,statusc:_}=((0,p.wA)(),(0,p.d4)(e=>e.customers)),[I,C]=(0,a.useState)([]),[k,D]=(0,a.useState)({account_id:null,type_id:null,belance:"0",date_created:"",user_id:localStorage.getItem("userTokenid"),isdelete:0}),[z,P]=(0,a.useState)([]),[W,N]=(0,a.useState)(h()()),[M,O]=(0,a.useState)(),[B,q]=(0,a.useState)({id:0,account_id:0,type_id:0,belance:"0",date_created:"",moneyType:"",account_name:"",moneyId:0,user_id:localStorage.getItem("userTokenid"),user_name:localStorage.getItem("userToken"),isdelete:0}),[T,E]=(0,a.useState)({national_id_picture:"",profile_picture:"",national_id_number:"",isdelete:"False",user_id:"",address:"",whatsup_number:"",name:"",father_name:"",phone_number:""}),[R,H]=(0,a.useState)([]),[G,F]=(0,a.useState)(),[Y,Q]=(0,a.useState)(),[V,K]=(0,a.useState)(),[L,$]=(0,a.useState)(""),U=(0,a.useRef)(null),X=e=>{"Enter"===e.key&&(e.preventDefault(),U.current&&B&&U.current.click())};return(0,a.useEffect)(()=>{if(L){if(!L||(null==L?void 0:L.length)<3)return void C([]);(async()=>{try{const e=(await i.A.get("".concat(o.A.getAddress(),"/api/customers"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))},params:{query:L,do:"ok"}})).data;C(e)}catch(e){}})()}},[L]),(0,A.jsxs)("div",{className:"rounded-4 row g-2 popup m-4 mb-0 ".concat(c&&"show"),style:{width:"20rem"},children:[(0,A.jsx)("div",{className:"d-flex justify-content-end m-0 p-0",children:(0,A.jsx)("button",{type:"button",class:"btn-close align-self-end p-3 m-1 mt-0 hover_btn",onClick:()=>{n()},"aria-label":"Close"})}),(0,A.jsx)("h1",{className:"text-center rounded m-0 p-2 w-100 text-light fs-4",style:{backgroundColor:"var(--bs-info)"},children:(0,A.jsx)(x.A,{id:"Add Account"})}),(0,A.jsxs)("div",{class:"col-md-6",children:[(0,A.jsx)("label",{for:"validationServer01",className:"fw-bold",children:(0,A.jsx)(x.A,{id:"Customer Name"})}),(0,A.jsx)(r.A,{name:(0,A.jsx)(x.A,{id:"Add Customer"}),setAddAccountModal:j,type:!0,searchQuery:L,handleInputChange:e=>{$(e)},setSelectedOption:e=>{O(e),e&&(E(e),D((0,s.A)((0,s.A)({},k),{},{account_id:e.id})),q((0,s.A)((0,s.A)({},B),{},{account_name:e.name,account_id:e.id})),H(e.missing_moneys))},selectedOption:M,options:I}),(0,A.jsx)("div",{class:"valid-feedback",children:"Looks good!"})]}),(0,A.jsxs)("div",{class:"col-md-6",children:[(0,A.jsx)("label",{for:"validationServer02",className:"fw-bold",children:(0,A.jsx)(x.A,{id:"Currency"})}),(0,A.jsx)("div",{className:"w-40",children:(0,A.jsx)(l.Ay,{onKeyDown:X,value:G,onChange:e=>{const t=(new Date).toISOString();if(F(e),e){D((0,s.A)((0,s.A)({},k),{},{user_id:localStorage.getItem("userTokenid"),type_id:e.id,date_created:t}));const n=m.length>0?Math.max(...m.map(e=>e.id))+1:1;q((0,s.A)((0,s.A)({},B),{},{user_id:localStorage.getItem("userTokenid"),type_id:e.id,id:n,belance:"0",date_created:t,moneyType:e.name,user_name:localStorage.getItem("userToken")}))}},options:R,getOptionLabel:e=>(0,A.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,A.jsx)("span",{children:"".concat(e.name," ")})}),getOptionValue:e=>"".concat(e.name),isClearable:!0,isSearchable:!0,isDisabled:!R})}),(0,A.jsx)("div",{class:"valid-feedback",children:"Looks good!"})]}),(0,A.jsx)("div",{className:"coll-10",children:(0,A.jsx)(u.A,{onKeyDown:X,default_value:"",handle_date:e=>{if(e){const{year:t,month:n,day:a}=e,o=(d().toGregorian(t,n,a),new Date);String(o.getHours()).padStart(2,"0"),String(o.getMinutes()).padStart(2,"0");const i=new Date(e.year,e.month-1,e.day,o.getHours(),o.getMinutes()).toISOString();D((0,s.A)((0,s.A)({},k),{},{date_created:i})),q((0,s.A)((0,s.A)({},B),{},{date_created:i}))}},lebal:(0,A.jsx)(x.A,{id:"Date"}),setSelectedDay:N,selectedDay:W})}),(0,A.jsxs)("div",{className:"col-10 ms-4 m-10 mt-5 ps-3 d-flex",children:[(0,A.jsx)("a",{className:"text-center form-control btn btn-danger text-light me-1 ms-1",style:{margin:"auto",width:"150px"},onClick:n,children:(0,A.jsx)(x.A,{id:"Cancel"})}),(0,A.jsx)("a",{className:"text-center btn form-control btn-success text-light ms-1",ref:U,style:{margin:"auto",width:"150px"},onClick:()=>{G?i.A.post(o.A.getAddress()+"/api/belance",k,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access")),"Content-Type":"application/json"}}).then(e=>{q(t=>[(0,s.A)((0,s.A)({},t),{},{id:e.data.id})]);let t={national_id_number:T.national_id_number,isdelete:T.isdelete,user:T.user,address:T.address,whatsup_number:T.whatsup_number,name:T.name,father_name:T.father_name,phone_number:T.phone_number,ontransaction:1};i.A.put(o.A.getAddress()+"/api/customers/"+"".concat(T.id,"/"),t,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("access"))}}).then(e=>{S({position:"top-end",icon:"success",title:(0,A.jsx)(x.A,{id:"Your record has been added!"}),showConfirmButton:!1,timer:800})}).catch(e=>{S({position:"top-end",icon:"error",title:(0,A.jsx)(x.A,{id:"Not working ,please try again!"}),showConfirmButton:!1,timer:800})}),D({account:null,type:null,belance:"0",date_created:"",user_id:localStorage.getItem("userTokenid"),isdelete:0}),O({name:""}),F(null),H(null),N(h()()),f([B,...m]),n()}).catch(e=>{S({position:"top-end",icon:"error",title:(0,A.jsx)(x.A,{id:"Not working ,please try again!"}),showConfirmButton:!1,timer:800})}):S({position:"top-end",icon:"error",title:(0,A.jsx)(x.A,{id:"You Must fill all inputs!"}),showConfirmButton:!1,timer:1e3})},children:(0,A.jsx)(x.A,{id:"Submit"})})]})]})}},61238:(e,t,n)=>{n.d(t,{A:()=>u});var s=n(89379),a=n(65043),o=n(21443),i=n(92382),r=n(97),l=n(53226),c=n(70579);const d=e=>{let{isDisabled:t=!1,options:n=[],selectedOption:d,setSelectedOption:u,width:m="100%"}=e;const{formatMessage:h,locale:p}=(0,r.A)(),x="fa"===p,g={name:(0,c.jsx)(l.A,{id:"All Users"}),id:0},A=[g,...n];(0,a.useEffect)(()=>{d||u(g)},[d,u,g]);const f={control:(e,t)=>(0,s.A)((0,s.A)({},e),{},{fontFamily:"en"!==localStorage.getItem("language")&&"'CustomFont1', sans-serif",backgroundColor:"#fff",zIndex:1,borderRadius:"8px",border:t.isFocused?"2px solid #4f46e5":"1px solid #d1d5db",boxShadow:t.isFocused?"0 0 5px rgba(79, 70, 229, 0.5)":"none","&:hover":{border:"1px solid #4f46e5"},minHeight:"39px",padding:"4px 8px",textAlign:x?"right":"left",direction:x?"rtl":"ltr"}),menu:e=>(0,s.A)((0,s.A)({},e),{},{fontFamily:"en"!==localStorage.getItem("language")&&"'CustomFont1', sans-serif",borderRadius:"8px",boxShadow:"0px 4px 10px rgba(0, 0, 0, 0.1)",overflow:"hidden",textAlign:x?"right":"left",direction:x?"rtl":"ltr"}),option:(e,t)=>{let{isFocused:n,isSelected:a}=t;return(0,s.A)((0,s.A)({},e),{},{fontFamily:"en"!==localStorage.getItem("language")&&"'CustomFont1', sans-serif",backgroundColor:a?"#4f46e5":n?"#e0e7ff":"#fff",color:a?"#fff":"#111827",padding:x?"12px 16px 12px 8px":"12px 8px 12px 16px",cursor:"pointer",fontSize:"14px",textAlign:x?"right":"left","&:active":{backgroundColor:"#4338ca"}})},singleValue:e=>(0,s.A)((0,s.A)({},e),{},{fontFamily:"en"!==localStorage.getItem("language")&&"'CustomFont1', sans-serif",fontWeight:"bold",color:"#4f46e5",fontSize:"14px",textAlign:x?"right":"left",direction:x?"rtl":"ltr"}),placeholder:e=>(0,s.A)((0,s.A)({},e),{},{fontFamily:"en"!==localStorage.getItem("language")&&"'CustomFont1', sans-serif",fontSize:"14px",color:"#6b7280",textAlign:x?"right":"left",direction:x?"rtl":"ltr"}),dropdownIndicator:e=>(0,s.A)((0,s.A)({},e),{},{fontFamily:"en"!==localStorage.getItem("language")&&"'CustomFont1', sans-serif",padding:"8px"}),menuPortal:e=>(0,s.A)((0,s.A)({},e),{},{zIndex:1e4}),input:e=>(0,s.A)((0,s.A)({},e),{},{fontFamily:"en"!==localStorage.getItem("language")&&"'CustomFont1', sans-serif",textAlign:x?"right":"left"})};return(0,c.jsx)("div",{className:"mt-3",style:{width:m},dir:x?"rtl":"ltr",children:(0,c.jsx)(o.Ay,{classNamePrefix:"custom-select",value:d,onChange:e=>{u(e)},options:A,getOptionLabel:e=>e.name,getOptionValue:e=>e.id,placeholder:h({id:"select.placeholder"})||(x?"انتخاب کنید...":"Select..."),isClearable:!1,isSearchable:!1,isDisabled:t,menuPortalTarget:document.body,styles:f,components:{DropdownIndicator:e=>{let{innerProps:t}=e;return(0,c.jsx)("div",(0,s.A)((0,s.A)({},t),{},{className:x?"pl-2 text-gray-500":"pr-2 text-gray-500",children:(0,c.jsx)(i.A,{size:20})}))},ClearIndicator:null}})})};d.defaultProps={isDisabled:!1,options:[],selectedOption:null,width:"100%"};const u=d}}]);
//# sourceMappingURL=845.04b5e926.chunk.js.map